/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package rrhh.sic_rrhh;

import com.itextpdf.text.Document;
import com.itextpdf.text.DocumentException;
import com.itextpdf.text.Font;
import com.itextpdf.text.Image;
import com.itextpdf.text.Paragraph;
import com.itextpdf.text.Phrase;
import com.itextpdf.text.pdf.PdfPCell;
import com.itextpdf.text.pdf.PdfPTable;
import com.itextpdf.text.pdf.PdfWriter;
import java.awt.Color;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.Toolkit;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.text.DecimalFormat;
import java.util.List;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JLabel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.table.DefaultTableModel;
import rrhh.Entidad.Empleado;
import rrhh.Entidad.Roles;
import rrhh.servicio.ServiceHb;
import java.util.Calendar;
import java.util.Date;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import javax.swing.JTextField;
import javax.swing.table.TableCellRenderer;
import javax.swing.table.TableColumnModel;
import rrhh.Entidad.Bono;
import rrhh.Entidad.Comisiones;
import rrhh.Entidad.Prestamos;
import rrhh.servicio.Funcion;
/**
 *
 * @author Matheus
 */
public final class ver_roles extends javax.swing.JPanel {
    Dimension d;
    Empleado emp;
    String direccion;
    int turno=1;
    int carpeta=1;
    /**
     * Creates new form inicio
     */
    public ver_roles() {
        initComponents();
        d = Toolkit.getDefaultToolkit().getScreenSize();
        setSize(d.width-100, d.height-61);
        //pdftotalindividual("Octubre","2014", TOOL_TIP_TEXT_KEY, TOOL_TIP_TEXT_KEY);
        ajustetable();
        fecha_update();
        setVisible(true);
    }
    public void ajustetable(){
        final TableColumnModel columnModel = jTable1.getColumnModel();
        for (int column = 0; column < jTable1.getColumnCount(); column++) {
            int width = 100; // Min width
            for (int row = 0; row < jTable1.getRowCount(); row++) {
                TableCellRenderer renderer = jTable1.getCellRenderer(row, column);
                Component comp = jTable1.prepareRenderer(renderer, row, column);
                width = Math.max(comp.getPreferredSize().width, width);
            }
            columnModel.getColumn(column).setPreferredWidth(width);
        }
    }
    
    public void setdirrrhh(String text){
        direccion=text;
    }
    public void fecha_update(){
        String[] fecha= {"Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"};
        jComboBox2.removeAllItems();
        jComboBox1.removeAllItems();
        Date f = new Date();
        Calendar calendar = Calendar.getInstance();
        calendar.setTime(f);
        for(int i=2013; i<2021;i++){
            jComboBox2.addItem(i);
        }
        for(int i=0; i<12;i++){
            jComboBox1.addItem(fecha[i]);
        }
        jComboBox2.setSelectedItem(calendar.get(Calendar.YEAR));
        jComboBox1.setSelectedItem(fecha[calendar.get(Calendar.MONTH)]);
    }
    
    public Dimension getD() {
        return d;
    }

    public void setD(Dimension d) {
        this.d = d;
    }

    public Empleado getEmp() {
        return emp;
    }

    public void setEmp(Empleado emp) {
        this.emp = emp;
    }

    public int getTurno() {
        return turno;
    }

    public void setTurno(int turno) {
        this.turno = turno;
    }    

    public JButton getjButton1() {
        return jButton1;
    }

    public void setjButton1(JButton jButton1) {
        this.jButton1 = jButton1;
    }

    public JComboBox getjComboBox1() {
        return jComboBox1;
    }

    public void setjComboBox1(JComboBox jComboBox1) {
        this.jComboBox1 = jComboBox1;
    }

    public JComboBox getjComboBox2() {
        return jComboBox2;
    }

    public void setjComboBox2(JComboBox jComboBox2) {
        this.jComboBox2 = jComboBox2;
    }

    public JLabel getjLabel1() {
        return jLabel1;
    }

    public void setjLabel1(JLabel jLabel1) {
        this.jLabel1 = jLabel1;
    }

    public JScrollPane getjScrollPane1() {
        return jScrollPane1;
    }

    public void setjScrollPane1(JScrollPane jScrollPane1) {
        this.jScrollPane1 = jScrollPane1;
    }

    public JTable getjTable1() {
        return jTable1;
    }

    public void setjTable1(JTable jTable1) {
        this.jTable1 = jTable1;
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jButton1 = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        jComboBox1 = new javax.swing.JComboBox();
        jComboBox2 = new javax.swing.JComboBox();
        jButton2 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        jTextField1 = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();

        setBackground(new java.awt.Color(255, 255, 255));
        setEnabled(false);
        setLayout(null);

        jButton1.setFont(new java.awt.Font("Roboto", 0, 12)); // NOI18N
        jButton1.setText("Ver Roles");
        jButton1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jButton1MouseClicked(evt);
            }
        });
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        add(jButton1);
        jButton1.setBounds(640, 20, 110, 30);

        jLabel1.setFont(new java.awt.Font("Roboto", 0, 12)); // NOI18N
        jLabel1.setText("Fecha:");
        add(jLabel1);
        jLabel1.setBounds(790, 20, 60, 30);

        jComboBox1.setFont(new java.awt.Font("Roboto", 0, 12)); // NOI18N
        add(jComboBox1);
        jComboBox1.setBounds(860, 20, 150, 30);

        jComboBox2.setFont(new java.awt.Font("Roboto", 0, 12)); // NOI18N
        add(jComboBox2);
        jComboBox2.setBounds(1020, 20, 90, 30);

        jButton2.setText("Archivos");
        jButton2.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jButton2MouseClicked(evt);
            }
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                jButton2MouseEntered(evt);
            }
        });
        add(jButton2);
        jButton2.setBounds(480, 20, 120, 30);

        jButton3.setText("CORREOS");
        jButton3.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jButton3MouseClicked(evt);
            }
        });
        add(jButton3);
        jButton3.setBounds(330, 20, 130, 30);

        jButton4.setText("Rol Individual");
        jButton4.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jButton4MouseClicked(evt);
            }
        });
        add(jButton4);
        jButton4.setBounds(20, 20, 140, 30);
        add(jTextField1);
        jTextField1.setBounds(170, 20, 140, 30);

        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Empleado", "Dias", "Sueldo Basico", "Horas Extras", "Comisiones", "IESS", "Suplementario", "Movilizacion", "P. Comisariato", "P. Quirografario", "IESS: Extension", "P. Hipotecario", "P. Empresa", "P. Cooperativo", "Multas", "Fondos", "Bonos", "Decimo Tercero", "Decimo Cuarto", "Alimentacion", "Liquidacion", "Total Bonos", "Reposiciones", "Varios", "Total", "Editar"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, true, true, true, false, false, true, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jTable1.setAutoResizeMode(javax.swing.JTable.AUTO_RESIZE_OFF);
        jTable1.setOpaque(false);
        jTable1.setRowHeight(24);
        jTable1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTable1MouseClicked(evt);
            }
        });
        jTable1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTable1KeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                jTable1KeyReleased(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                jTable1KeyTyped(evt);
            }
        });
        jScrollPane1.setViewportView(jTable1);

        add(jScrollPane1);
        jScrollPane1.setBounds(20, 70, 1090, 480);
    }// </editor-fold>//GEN-END:initComponents

    private void jButton1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jButton1MouseClicked
        try{
            ServiceHb helper = new ServiceHb();
            helper.iniciarTransaccion();
            List<Roles> roles =helper.getRolesgenerales(getjComboBox1().getSelectedItem().toString(),getjComboBox2().getSelectedItem().toString());
            DefaultTableModel temp = (DefaultTableModel) getjTable1().getModel();
            for(int i=temp.getRowCount()-1;i>=0;i--){
               temp.removeRow(i);
            }
            if(roles!=null){
            int i=0;
            for(Roles x:roles){
                if(getjTable1().getRowCount()< roles.size()){
                    DefaultTableModel tempa = (DefaultTableModel) getjTable1().getModel();
                    Object nuevo[]= {tempa.getRowCount()+1,"",""};
                    tempa.addRow(nuevo);
                }
                    Empleado empleado=(Empleado)helper.obtenerObjeto(Empleado.class, Integer.parseInt(x.getCi()));
                    String nombre= empleado.getNombre1()+" "+empleado.getNombre2()+" "+empleado.getApellido1()+" "+empleado.getApellido2();
                    getjTable1().getModel().setValueAt(nombre, i, 0);
                    getjTable1().getModel().setValueAt(x.getDias(), i, 1);
                    getjTable1().getModel().setValueAt(x.getSueldo() , i, 2);
                    getjTable1().getModel().setValueAt(x.getSuplementaria2() , i, 3);
                    getjTable1().getModel().setValueAt(x.getIess(), i, 4);
                    getjTable1().getModel().setValueAt(x.getSuplementaria(), i, 5);
                    getjTable1().getModel().setValueAt(x.getPrestamo1(), i, 6);
                    getjTable1().getModel().setValueAt(x.getPrestamo2(), i, 7);
                    getjTable1().getModel().setValueAt(x.getPrestamo3(), i, 8);
                    getjTable1().getModel().setValueAt(x.getPrestamo4(), i, 9);
                    getjTable1().getModel().setValueAt(x.getPrestamo5(), i, 10);
                    getjTable1().getModel().setValueAt(x.getPrestamo6(), i, 11);
                    getjTable1().getModel().setValueAt(x.getMultas(), i, 12);
                    getjTable1().getModel().setValueAt(x.getFondos(), i, 13);
                    getjTable1().getModel().setValueAt(x.getBonos(), i, 14);
                    getjTable1().getModel().setValueAt(x.getReposiciones(), i, 15);
                    getjTable1().getModel().setValueAt(x.getVarios(), i, 16);
                    getjTable1().getModel().setValueAt(x.getTotal(), i, 17);
                    i++;
                }
            }
            helper.cerrarSesion();
        }
        catch(Exception io){
            
        }
    }//GEN-LAST:event_jButton1MouseClicked

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton1ActionPerformed

    private void jButton2MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jButton2MouseClicked
        try{
            String mes=jComboBox1.getSelectedItem().toString();
            String anio=jComboBox2.getSelectedItem().toString();
            JFileChooser chooser = new JFileChooser();
            chooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            int respuesta = chooser.showOpenDialog(this);
            String cadena="";
            if (respuesta == JFileChooser.APPROVE_OPTION)
            {
                cadena = chooser.getSelectedFile().getAbsolutePath();
                pdftotalestela(mes, anio,cadena);
                pdftotaleljuri(mes, anio,cadena);
                pdftotaltrebol(mes, anio,cadena);
                pdftotal(mes, anio,cadena);
                pdftotal2(mes, anio,cadena);
                pdftotaladmin(mes, anio,cadena);
                JOptionPane.showMessageDialog(null, " PDF Generados ");
            }

        }
        catch(Exception io){
            
        }
        //crearexcel(horas,bono,anticipos,prestamos,multa,roles,mes,anio);
                
        //crearexcel4(horas,bono,anticipos,prestamos,multa,roles,request.getParameter("mes"),request.getParameter("anioo"));

        

        //crearexcel2(horas,bono,anticipos,prestamos,multa,roles,mes, anio);       

    }//GEN-LAST:event_jButton2MouseClicked

    private void jButton3MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jButton3MouseClicked
        JavaMail mail = new JavaMail();
        try{
            ServiceHb helper = new ServiceHb();
            helper.iniciarTransaccion();
            List<Roles> em = helper.getRolesgenerales(jComboBox1.getSelectedItem().toString(), jComboBox2.getSelectedItem().toString());
            String mes=jComboBox1.getSelectedItem().toString();
            String anio=jComboBox2.getSelectedItem().toString();
            int noenvio=0;
            for(Roles i: em){
                Empleado emplead=null;
                if(isNumeric(i.getCi())){
                    emplead = helper.getPersonasCid2((i.getCi()));
                    if(emplead==null){
                        emplead = helper.getPersonasCid((i.getCi()));
                    }
                }else{
                    emplead = helper.getPersonasCid((i.getCi()));
                }
                String correo=emplead.getCorreo();
                if(correo.equalsIgnoreCase("")){
                    noenvio++;
                }else{                    
                    mail.email("ivan.puero@cajamarca.ec;","Rol de Pago de "+mes+", "+anio,"Saludos Sr(a). "+i.getNombre()+" aqui se Adjunta su Rol correspondiente al mes de "+mes+", "+anio+".",mes+anio+i.getCi(),correo,"MES:"+mes+"AÑO:"+anio+" "+i.getNombre());
                }
            }
            helper.cerrarSesion();
            JOptionPane.showMessageDialog(null, " Los emails han sido enviados excepto"+ noenvio);
        }catch(Exception io){
        }
    }//GEN-LAST:event_jButton3MouseClicked

    private void jButton4MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jButton4MouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton4MouseClicked

    private void jButton2MouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jButton2MouseEntered
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton2MouseEntered

    private void jTable1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTable1MouseClicked
        
    }//GEN-LAST:event_jTable1MouseClicked

    private void jTable1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTable1KeyPressed
        
    }//GEN-LAST:event_jTable1KeyPressed

    private void jTable1KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTable1KeyReleased
        // TODO add your handling code here:
    }//GEN-LAST:event_jTable1KeyReleased

    private void jTable1KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTable1KeyTyped

    }//GEN-LAST:event_jTable1KeyTyped

    public int getCarpeta() {
        return carpeta;
    }

    public void setCarpeta(int carpeta) {
        this.carpeta = carpeta;
    }

    public JButton getjButton2() {
        return jButton2;
    }

    public void setjButton2(JButton jButton2) {
        this.jButton2 = jButton2;
    }

    public JButton getjButton3() {
        return jButton3;
    }

    public void setjButton3(JButton jButton3) {
        this.jButton3 = jButton3;
    }

    public JButton getjButton4() {
        return jButton4;
    }

    public void setjButton4(JButton jButton4) {
        this.jButton4 = jButton4;
    }

    public void pdftotal2(String mes, String anio, String dire){
        //String imagepath = Server.MapPath("Images");
        Document documento = new Document();
        float hora=0;
        float prestamo=0;
        float bonoa=0;
        float multaa=0;
        int mesnum=0;
        String[] fecha= {"Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"};
        for(int i=0; i<12;i++){
            if(fecha[i].equalsIgnoreCase(mes)){
                mesnum=i;
            }
        }
        FileOutputStream ficheroPdf=null;
        
        try
        {
            ficheroPdf = new FileOutputStream(dire+"\\"+mes+anio+"CajamarcaQuito.pdf");
//            ficheroPdf = new FileOutputStream("C:\\Users\\Matheus\\Desktop\\pruebas\\"+mes+anio+"Cajamarca.pdf");
            PdfWriter.getInstance(documento,ficheroPdf).setInitialLeading(20);
        }
        catch (FileNotFoundException | DocumentException ex)
        {
            System.out.println(ex.toString());
        }
        Empleado emplead = null;
        String cadena="";
        try{
            ServiceHb helper = new ServiceHb();
            helper.iniciarTransaccion();
            documento.open();
            List<Roles> roles=helper.getRolesgenerales(mes, anio);
            int temp=0;
            int tempt=roles.size();
            for(Roles rol : roles){
                cadena=rol.getCi();
                temp++;
                System.out.println(temp+"/"+tempt);
                bonoa= Float.parseFloat(rol.getBon());
                multaa= Float.parseFloat(rol.getMultas());
                hora = Float.parseFloat(rol.getReposiciones());
                if(isNumeric(rol.getCi())){
                    emplead = helper.getPersonasCid2((rol.getCi()));
                    if(emplead==null){
                        emplead = helper.getPersonasCid((rol.getCi()));
                    }
                }else{
                    emplead = helper.getPersonasCid((rol.getCi()));
                }
                if(emplead!=null){
                if(emplead.getDeptEmpl().getDepartamento().getNombre().equalsIgnoreCase("Seguridad Fisica")&&emplead.getCuidadResidencia().contains("Quito")&&!emplead.getCiudad().contains("La Estela")&&!emplead.getCiudad().contains("Juan Eljuri")&&!emplead.getCiudad().contains("Trebol Verde")){
                emp=emplead;
                List<Bono> otros =helper.getBonomesByTipo3(""+emp.getCid(),mes, anio);
                List<Prestamos> otros2 =helper.getPrestamosmesByTipo3(""+emp.getCid(),mes, anio);
                List<Comisiones> v6= helper.getComisionesmesByTipo(""+emp.getCid(), mes, anio);    
                float empresa= Float.parseFloat(rol.getPrestamo5());
                float quiro=Float.parseFloat(rol.getPrestamo2());
                float comi=Float.parseFloat(rol.getPrestamo1());
                float ext=Float.parseFloat(rol.getPrestamo3());
                float medi=Float.parseFloat(rol.getPrestamo8());
                
                float hipo=Float.parseFloat(rol.getPrestamo4());
                float coop=Float.parseFloat(rol.getPrestamo6());
                float comunes=Float.parseFloat(rol.getPrestamo7());
                prestamo= empresa+quiro+comi+ext+hipo+coop+comunes;
                
                if(ext!=0){
                    if(otros2!=null){
                        ext=ext+Float.parseFloat(otros2.get(0).getValor().replace("-", ""));
                    }
                }
                float totalA=0;
                float sup= Float.parseFloat(rol.getSuplementaria());
                float sup2= Float.parseFloat(rol.getSuplementaria2());
                DecimalFormat df = new DecimalFormat("#.##");
                DecimalFormat df2 = new DecimalFormat("#.##");
                float pago=Float.parseFloat(rol.getSueldo());
                float iess=Float.parseFloat(rol.getIess());
                float fondo=Float.parseFloat(rol.getFondos());
                Image image1 = Image.getInstance(direccion+"logo-mkt.png");
                float bonoss=(bonoa + hora);
                if(otros!=null){
                    bonoss=bonoss-Float.parseFloat(otros.get(0).getValor());
                }
                float desc=  multaa - iess + prestamo;
                
                /*PDF CREATOR*/
                PdfPTable border = new PdfPTable(4);
                PdfPTable border1 = new PdfPTable(2);
                PdfPTable border2 = new PdfPTable(2);
                
                PdfPTable tabla = new PdfPTable(1);
                PdfPCell celda = new PdfPCell();
                image1.scaleAbsolute(60f, 40f);
                celda.setImage(image1);
                celda.setBorder(0);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(3);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo1 = new Paragraph("ROL DE PAGOS INDIVIDUAL",new Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                documento.add(new Paragraph(" "));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(parrafo1);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo2 = new Paragraph("EMPLEADO",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo2a = new Paragraph(emplead.getNombre1()+" "+emplead.getNombre2()+" "+emplead.getApellido1()+" "+emplead.getApellido2(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo2);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo2a);
                border1.addCell(celda);

                
                Calendar ahoraCal = Calendar.getInstance();
                Date fe = new Date();
                ahoraCal.set(Integer.parseInt(anio), mesnum, 1);
                ahoraCal.set(Integer.parseInt(anio), mesnum, ahoraCal.getActualMaximum(Calendar.DAY_OF_MONTH));
                Paragraph parrafo3 = new Paragraph("FECHA",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo3a = new Paragraph(Funcion.DateFormat(ahoraCal.getTime()),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo3);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo3a);
                border2.addCell(celda);

                Paragraph parrafo4 = new Paragraph("CARGO",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo4a = new Paragraph(emplead.getPerfilpuesto(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                Paragraph parrafo41 = new Paragraph("Dias",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo41a = new Paragraph(rol.getDias(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo4);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo4a);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo41);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo41a);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo5 = new Paragraph("INGRESOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo5a = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo5);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);

                Paragraph parrafo6 = new Paragraph("DESCUENTOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo6a = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo6);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo7 = new Paragraph("Sueldo Base",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo7a = new Paragraph("$ "+rol.getSueldo(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                double cmi=0;
                if(v6!=null){
                    for(Comisiones z : v6){
                        cmi = cmi + Double.parseDouble(z.getValor());
                    }
                }
                Paragraph parrafocomi = new Paragraph("Comisiones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafocomia = new Paragraph("$ "+df.format(cmi).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo7);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo7a);
                border1.addCell(celda);
                if(v6!=null){
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafocomi);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafocomia);
                border1.addCell(celda);
                }
                Paragraph parrafo8 = new Paragraph("Aportes IESS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo8a = new Paragraph("$ -"+df.format(iess).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo8);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo8a);
                border2.addCell(celda);

                Paragraph parrafo9 = new Paragraph("Horas Extras",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo9a = new Paragraph("$ "+df2.format(sup2),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo9);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo9a);
                border1.addCell(celda);

                Paragraph parrafo10 = new Paragraph("Préstamos IESS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo10a = new Paragraph("$ "+df2.format(quiro+hipo),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo10);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo10a);
                border2.addCell(celda);

                Paragraph bonos;
                if((sup+Float.parseFloat(rol.getAlimentacion()))<300){
                    bonos = new Paragraph("Alimentación y Transporte",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                }else{
                    bonos = new Paragraph("Alimentación y Viaticos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                }
                Paragraph bonosa = new Paragraph("$ "+df.format(sup+Float.parseFloat(rol.getAlimentacion())+Float.parseFloat(rol.getMobilizacion())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(bonos);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(bonosa);
                border1.addCell(celda);

                Paragraph parrafo12 = new Paragraph("Préstamos Y Anticipos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo12a = new Paragraph("$ "+df.format(empresa+comunes),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo12);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo12a);
                border2.addCell(celda);

                Paragraph parrafo13 = new Paragraph("Bonos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo13a = new Paragraph("$ "+df.format(bonoss),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo13);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo13a);
                border1.addCell(celda);

                Paragraph comisariato = new Paragraph("Comisariato",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph comisariatoa = new Paragraph("$ "+df.format(comi),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(comisariato);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(comisariatoa);
                border2.addCell(celda);
                
                Paragraph fondos = new Paragraph("Fondos de Reserva",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph fondosa = new Paragraph("$ "+df.format(fondo),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                if(fondo!=0){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(fondos);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(fondosa);
                    border1.addCell(celda);
                }
                
                Paragraph parrafo14 = new Paragraph("Multas",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo14a = new Paragraph("$ "+df.format(multaa),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo14);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo14a);
                border2.addCell(celda);
                                /*****************/
                Paragraph vacaciones = new Paragraph("Liq. Vacaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph vacacionesa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getLiquidacion())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                //Vacaciones
                if(!rol.getLiquidacion().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(vacaciones);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(vacacionesa);
                    border1.addCell(celda);
                }

                Paragraph tercero = new Paragraph("Decimotercero Mensual",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph terceroa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimotercero())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                
                if(!rol.getDecimotercero().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(tercero);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(terceroa);
                    border1.addCell(celda);
                }
                
                Paragraph cuarto = new Paragraph("Decimocuarto Mensual",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph cuartoa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimocuarto())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(!rol.getDecimocuarto().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(cuarto);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(cuartoa);
                    border1.addCell(celda);
                }
                
                Paragraph excuarto = new Paragraph("Liq. Decimotercero Dic-Jul 2015",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph excuartoa = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(otros!=null){
                    excuartoa = new Paragraph("$ "+df.format(Double.parseDouble(otros.get(0).getValor())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(excuarto);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(excuartoa);
                    border1.addCell(celda);
                }
                
                Paragraph extension = new Paragraph("IESS: Extensión a Cónyuges",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona = new Paragraph("$ "+df.format(ext),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(ext!=0){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona);
                    border2.addCell(celda);

                }
                Paragraph extension23 = new Paragraph("Medilink",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona23 = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                if(medi!=0){
                    Float fl = Float.parseFloat(rol.getPrestamo8().replace("-", ""));
                    extensiona23 = new Paragraph("$ -"+df.format(fl),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension23);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona23);
                    border2.addCell(celda);
                }
                Paragraph extension2 = new Paragraph("Anticipo por Vacaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona2 = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(otros2!=null){
                    Float fl = Float.parseFloat(otros2.get(0).getValor().replace("-", ""));
                    extensiona2 = new Paragraph("$ -"+df.format(fl),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension2);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona2);
                    border2.addCell(celda);
                }
                
                celda= new PdfPCell(border1);
                celda.setBorder(0);
                celda.setColspan(2);
                border.addCell(celda);
                
                celda= new PdfPCell(border2);
                celda.setBorder(0);
                celda.setColspan(2);
                border.addCell(celda);
                
                Paragraph parrafo15 = new Paragraph("TOTAL INGRESOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                if(otros!=null){
                    bonoss=bonoss+Float.parseFloat(otros.get(0).getValor());
                }
                float liq= Float.parseFloat(rol.getLiquidacion());
                Float n = Float.parseFloat(rol.getSueldo()) + liq +bonoss + fondo +sup +sup2+Float.parseFloat(rol.getDecimotercero())+Float.parseFloat(rol.getDecimocuarto())+Float.parseFloat(rol.getAlimentacion())+Float.parseFloat(rol.getComisiones())+Float.parseFloat(rol.getMobilizacion());
                Paragraph parrafo15a = new Paragraph("$ "+df.format(n),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo15);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo15a);
                border.addCell(celda);
                
                
                Paragraph parrafo16 = new Paragraph("TOTAL DESCUENTOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo16a = new Paragraph("$ "+df.format(desc).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 6, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo16);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo16a);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);


                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo17 = new Paragraph("NETO A PAGAR",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo17a = new Paragraph("$ "+rol.getTotal(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo17);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo17a);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo22 = new Paragraph("______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo22);
                border.addCell(celda);

                Paragraph parrafo18 = new Paragraph("______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo18);
                border.addCell(celda);

                Paragraph parrafo21 = new Paragraph("Emitido Por",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo21);
                border.addCell(celda);

                Paragraph parrafo19 = new Paragraph("RECIBÍ CONFORME",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo19);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo20 = new Paragraph("C.I. ______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo20);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);
                Paragraph parrafo23 = new Paragraph("Observaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                if(v6!=null){
                            celda = new PdfPCell();
                            celda.setBorder(0);
                            celda.setColspan(1);
                            celda.setPhrase(parrafo23);
                            border.addCell(celda);
                            
                            celda = new PdfPCell();
                            celda.setBorder(0);
                            celda.setColspan(3);
                            celda.setHorizontalAlignment(1);
                            celda.setPhrase(new Phrase(""));
                            border.addCell(celda);
                            
                            for(Comisiones r: v6){
                                celda = new PdfPCell();
                                celda.setBorder(0);
                                celda.setColspan(4);
                                celda.setPhrase(new Paragraph(r.getDetalle() +"por el valor de: $"+r.getValor(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0))));
                                border.addCell(celda);
                            }
                        }
                
                PdfPCell bord2 = new PdfPCell();
                bord2.setBorder(1);
                bord2= new PdfPCell(border);

                tabla.addCell(bord2);
                documento.add(tabla);
            }
            }
            }
            documento.close();
            helper.cerrarSesion();
        }catch(Exception ex){
            System.out.println(emplead.getApellido1());
            documento.close();
        }
        
    }
public void pdftotal(String mes, String anio, String dire){
        //String imagepath = Server.MapPath("Images");
        Document documento = new Document();
        float hora=0;
        float prestamo=0;
        float bonoa=0;
        float multaa=0;
        int mesnum=0;
        String[] fecha= {"Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"};
        for(int i=0; i<12;i++){
            if(fecha[i].equalsIgnoreCase(mes)){
                mesnum=i;
            }
        }
        FileOutputStream ficheroPdf=null;
        
        try
        {
            ficheroPdf = new FileOutputStream(dire+"\\"+mes+anio+"CajamarcaGuayaquil.pdf");
//            ficheroPdf = new FileOutputStream("C:\\Users\\Matheus\\Desktop\\pruebas\\"+mes+anio+"Cajamarca.pdf");
            PdfWriter.getInstance(documento,ficheroPdf).setInitialLeading(20);
        }
        catch (FileNotFoundException | DocumentException ex)
        {
            System.out.println(ex.toString());
        }
        Empleado emplead = null;
        String cadena="";
        try{
            ServiceHb helper = new ServiceHb();
            helper.iniciarTransaccion();
            documento.open();
            List<Roles> roles=helper.getRolesgenerales(mes, anio);
            int temp=0;
            int tempt=roles.size();
            for(Roles rol : roles){
                cadena=rol.getCi();
                temp++;
                System.out.println(temp+"/"+tempt);
                if(temp==66){
                    System.out.println("");
                }
                bonoa= Float.parseFloat(rol.getBon());
                multaa= Float.parseFloat(rol.getMultas());
                hora = Float.parseFloat(rol.getReposiciones());
                if(isNumeric(rol.getCi())){
                    emplead = helper.getPersonasCid2((rol.getCi()));
                    if(emplead==null){
                        emplead = helper.getPersonasCid((rol.getCi()));
                    }
                }else{
                    emplead = helper.getPersonasCid((rol.getCi()));
                }
                if(emplead!=null){
                if(emplead.getDeptEmpl().getDepartamento().getNombre().equalsIgnoreCase("Seguridad Fisica")&&!emplead.getCuidadResidencia().contains("Quito")&&!emplead.getCiudad().contains("La Estela")&&!emplead.getCiudad().contains("Juan Eljuri")&&!emplead.getCiudad().contains("Trebol Verde")){
                emp=emplead;
                List<Bono> otros =helper.getBonomesByTipo3(""+emp.getCid(),mes, anio);
                List<Prestamos> otros2 =helper.getPrestamosmesByTipo3(""+emp.getCid(),mes, anio);
                List<Comisiones> v6= helper.getComisionesmesByTipo(""+emp.getCid(), mes, anio);    
                float empresa= Float.parseFloat(rol.getPrestamo5());
                float quiro=Float.parseFloat(rol.getPrestamo2());
                float comi=Float.parseFloat(rol.getPrestamo1());
                float ext=Float.parseFloat(rol.getPrestamo3());
                float medi=Float.parseFloat(rol.getPrestamo8());
                
                float hipo=Float.parseFloat(rol.getPrestamo4());
                float coop=Float.parseFloat(rol.getPrestamo6());
                float comunes=Float.parseFloat(rol.getPrestamo7());
                prestamo= empresa+quiro+comi+ext+hipo+coop+comunes;
                
                if(ext!=0){
                    if(otros2!=null){
                        ext=ext+Float.parseFloat(otros2.get(0).getValor().replace("-", ""));
                    }
                }
                float totalA=0;
                float sup= Float.parseFloat(rol.getSuplementaria());
                float sup2= Float.parseFloat(rol.getSuplementaria2());
                DecimalFormat df = new DecimalFormat("#.##");
                DecimalFormat df2 = new DecimalFormat("#.##");
                float pago=Float.parseFloat(rol.getSueldo());
                float iess=Float.parseFloat(rol.getIess());
                float fondo=Float.parseFloat(rol.getFondos());
                Image image1 = Image.getInstance(direccion+"logo-mkt.png");
                float bonoss=(bonoa + hora);
                if(otros!=null){
                    bonoss=bonoss-Float.parseFloat(otros.get(0).getValor());
                }
                float desc=  multaa - iess + prestamo;
                
                /*PDF CREATOR*/
                PdfPTable border = new PdfPTable(4);
                PdfPTable border1 = new PdfPTable(2);
                PdfPTable border2 = new PdfPTable(2);
                
                PdfPTable tabla = new PdfPTable(1);
                PdfPCell celda = new PdfPCell();
                image1.scaleAbsolute(60f, 40f);
                celda.setImage(image1);
                celda.setBorder(0);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(3);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo1 = new Paragraph("ROL DE PAGOS INDIVIDUAL",new Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                documento.add(new Paragraph(" "));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(parrafo1);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo2 = new Paragraph("EMPLEADO",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo2a = new Paragraph(emplead.getNombre1()+" "+emplead.getNombre2()+" "+emplead.getApellido1()+" "+emplead.getApellido2(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo2);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo2a);
                border1.addCell(celda);

                
                Calendar ahoraCal = Calendar.getInstance();
                Date fe = new Date();
                ahoraCal.set(Integer.parseInt(anio), mesnum, 1);
                ahoraCal.set(Integer.parseInt(anio), mesnum, ahoraCal.getActualMaximum(Calendar.DAY_OF_MONTH));
                Paragraph parrafo3 = new Paragraph("FECHA",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo3a = new Paragraph(Funcion.DateFormat(ahoraCal.getTime()),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo3);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo3a);
                border2.addCell(celda);

                Paragraph parrafo4 = new Paragraph("CARGO",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo4a = new Paragraph(emplead.getPerfilpuesto(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                Paragraph parrafo41 = new Paragraph("Dias",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo41a = new Paragraph(rol.getDias(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo4);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo4a);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo41);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo41a);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo5 = new Paragraph("INGRESOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo5a = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo5);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);

                Paragraph parrafo6 = new Paragraph("DESCUENTOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo6a = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo6);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo7 = new Paragraph("Sueldo Base",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo7a = new Paragraph("$ "+rol.getSueldo(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                double cmi=0;
                if(v6!=null){
                    for(Comisiones z : v6){
                        cmi = cmi + Double.parseDouble(z.getValor());
                    }
                }
                Paragraph parrafocomi = new Paragraph("Comisiones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafocomia = new Paragraph("$ "+df.format(cmi).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo7);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo7a);
                border1.addCell(celda);
                if(v6!=null){
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafocomi);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafocomia);
                border1.addCell(celda);
                }
                Paragraph parrafo8 = new Paragraph("Aportes IESS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo8a = new Paragraph("$ -"+df.format(iess).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo8);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo8a);
                border2.addCell(celda);

                Paragraph parrafo9 = new Paragraph("Horas Extras",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo9a = new Paragraph("$ "+df2.format(sup2),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo9);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo9a);
                border1.addCell(celda);

                Paragraph parrafo10 = new Paragraph("Préstamos IESS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo10a = new Paragraph("$ "+df2.format(quiro+hipo),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo10);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo10a);
                border2.addCell(celda);

                Paragraph bonos;
                if((sup+Float.parseFloat(rol.getAlimentacion()))<300){
                    bonos = new Paragraph("Alimentación y Transporte",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                }else{
                    bonos = new Paragraph("Alimentación y Viaticos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                }
                Paragraph bonosa = new Paragraph("$ "+df.format(sup+Float.parseFloat(rol.getAlimentacion())+Float.parseFloat(rol.getMobilizacion())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(bonos);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(bonosa);
                border1.addCell(celda);

                Paragraph parrafo12 = new Paragraph("Préstamos Y Anticipos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo12a = new Paragraph("$ "+df.format(empresa+comunes),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo12);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo12a);
                border2.addCell(celda);

                Paragraph parrafo13 = new Paragraph("Bonos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo13a = new Paragraph("$ "+df.format(bonoss),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo13);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo13a);
                border1.addCell(celda);

                Paragraph comisariato = new Paragraph("Comisariato",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph comisariatoa = new Paragraph("$ "+df.format(comi),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(comisariato);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(comisariatoa);
                border2.addCell(celda);
                
                Paragraph fondos = new Paragraph("Fondos de Reserva",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph fondosa = new Paragraph("$ "+df.format(fondo),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                if(fondo!=0){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(fondos);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(fondosa);
                    border1.addCell(celda);
                }
                
                Paragraph parrafo14 = new Paragraph("Multas",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo14a = new Paragraph("$ "+df.format(multaa),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo14);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo14a);
                border2.addCell(celda);
                                /*****************/
                Paragraph vacaciones = new Paragraph("Liq. Vacaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph vacacionesa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getLiquidacion())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                //Vacaciones
                if(!rol.getLiquidacion().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(vacaciones);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(vacacionesa);
                    border1.addCell(celda);
                }

                Paragraph tercero = new Paragraph("Decimotercero Mensual",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph terceroa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimotercero())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                
                if(!rol.getDecimotercero().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(tercero);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(terceroa);
                    border1.addCell(celda);
                }
                
                Paragraph cuarto = new Paragraph("Decimocuarto Mensual",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph cuartoa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimocuarto())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(!rol.getDecimocuarto().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(cuarto);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(cuartoa);
                    border1.addCell(celda);
                }
                
                Paragraph excuarto = new Paragraph("Liq. Decimotercero Dic-Jul 2015",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph excuartoa = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(otros!=null){
                    excuartoa = new Paragraph("$ "+df.format(Double.parseDouble(otros.get(0).getValor())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(excuarto);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(excuartoa);
                    border1.addCell(celda);
                }
                
                Paragraph extension = new Paragraph("IESS: Extensión a Cónyuges",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona = new Paragraph("$ "+df.format(ext),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(ext!=0){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona);
                    border2.addCell(celda);

                }
                
                Paragraph extension23 = new Paragraph("Medilink",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona23 = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                if(medi!=0){
                    Float fl = Float.parseFloat(rol.getPrestamo8().replace("-", ""));
                    extensiona23 = new Paragraph("$ -"+df.format(fl),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension23);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona23);
                    border2.addCell(celda);
                }
                Paragraph extension2 = new Paragraph("Anticipo por Vacaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona2 = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(otros2!=null){
                    Float fl = Float.parseFloat(otros2.get(0).getValor().replace("-", ""));
                    extensiona2 = new Paragraph("$ -"+df.format(fl),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension2);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona2);
                    border2.addCell(celda);
                }
                
                celda= new PdfPCell(border1);
                celda.setBorder(0);
                celda.setColspan(2);
                border.addCell(celda);
                
                celda= new PdfPCell(border2);
                celda.setBorder(0);
                celda.setColspan(2);
                border.addCell(celda);
                
                Paragraph parrafo15 = new Paragraph("TOTAL INGRESOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                if(otros!=null){
                    bonoss=bonoss+Float.parseFloat(otros.get(0).getValor());
                }
                float liq= Float.parseFloat(rol.getLiquidacion());
                Float n = Float.parseFloat(rol.getSueldo()) + liq +bonoss + fondo +sup +sup2+Float.parseFloat(rol.getDecimotercero())+Float.parseFloat(rol.getDecimocuarto())+Float.parseFloat(rol.getAlimentacion())+Float.parseFloat(rol.getComisiones())+Float.parseFloat(rol.getMobilizacion());
                Paragraph parrafo15a = new Paragraph("$ "+df.format(n),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo15);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo15a);
                border.addCell(celda);
                
                
                Paragraph parrafo16 = new Paragraph("TOTAL DESCUENTOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo16a = new Paragraph("$ "+df.format(desc).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 6, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo16);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo16a);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);


                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo17 = new Paragraph("NETO A PAGAR",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo17a = new Paragraph("$ "+rol.getTotal(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo17);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo17a);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo22 = new Paragraph("______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo22);
                border.addCell(celda);

                Paragraph parrafo18 = new Paragraph("______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo18);
                border.addCell(celda);

                Paragraph parrafo21 = new Paragraph("Emitido Por",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo21);
                border.addCell(celda);

                Paragraph parrafo19 = new Paragraph("RECIBÍ CONFORME",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo19);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo20 = new Paragraph("C.I. ______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo20);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);
                Paragraph parrafo23 = new Paragraph("Observaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                if(v6!=null){
                            celda = new PdfPCell();
                            celda.setBorder(0);
                            celda.setColspan(1);
                            celda.setPhrase(parrafo23);
                            border.addCell(celda);
                            
                            celda = new PdfPCell();
                            celda.setBorder(0);
                            celda.setColspan(3);
                            celda.setHorizontalAlignment(1);
                            celda.setPhrase(new Phrase(""));
                            border.addCell(celda);
                            
                            for(Comisiones r: v6){
                                celda = new PdfPCell();
                                celda.setBorder(0);
                                celda.setColspan(4);
                                celda.setPhrase(new Paragraph(r.getDetalle() +"por el valor de: $"+r.getValor(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0))));
                                border.addCell(celda);
                            }
                        }
                
                PdfPCell bord2 = new PdfPCell();
                bord2.setBorder(1);
                bord2= new PdfPCell(border);

                tabla.addCell(bord2);
                documento.add(tabla);
            }
            }
            }
            documento.close();
            helper.cerrarSesion();
        }catch(Exception ex){
            System.out.println(emplead.getApellido1());
            documento.close();
        }
        
    }
    
    public void pdftotalestela(String mes, String anio, String dire){
        //String imagepath = Server.MapPath("Images");
        Document documento = new Document();
        float hora=0;
        float prestamo=0;
        float bonoa=0;
        float multaa=0;
        int mesnum=0;
        String[] fecha= {"Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"};
        for(int i=0; i<12;i++){
            if(fecha[i].equalsIgnoreCase(mes)){
                mesnum=i;
            }
        }
        FileOutputStream ficheroPdf=null;
        
        try
        {
            ficheroPdf = new FileOutputStream(dire+"\\"+mes+anio+"CajamarcaEstela.pdf");
//            ficheroPdf = new FileOutputStream("C:\\Users\\Matheus\\Desktop\\pruebas\\"+mes+anio+"Cajamarca.pdf");
            PdfWriter.getInstance(documento,ficheroPdf).setInitialLeading(20);
        }
        catch (FileNotFoundException | DocumentException ex)
        {
            System.out.println(ex.toString());
        }
        Empleado emplead = null;
        String cadena="";
        try{
            ServiceHb helper = new ServiceHb();
            helper.iniciarTransaccion();
            documento.open();
            List<Roles> roles=helper.getRolesgenerales(mes, anio);
            int temp=0;
            int tempt=roles.size();
            for(Roles rol : roles){
                cadena=rol.getCi();
                temp++;
                System.out.println(temp+"/"+tempt);
                if(temp==129){
                    System.out.println("");
                }
                bonoa= Float.parseFloat(rol.getBon());
                multaa= Float.parseFloat(rol.getMultas());
                hora = Float.parseFloat(rol.getReposiciones());
                if(isNumeric(rol.getCi())){
                    emplead = helper.getPersonasCid2((rol.getCi()));
                    if(emplead==null){
                        emplead = helper.getPersonasCid((rol.getCi()));
                    }
                }else{
                    emplead = helper.getPersonasCid((rol.getCi()));
                }
                if(emplead!=null){
                if(emplead.getDeptEmpl().getDepartamento().getNombre().equalsIgnoreCase("Seguridad Fisica")&&emplead.getCiudad().contains("La Estela")){
                emp=emplead;
                List<Bono> otros =helper.getBonomesByTipo3(""+emp.getCid(),mes, anio);
                List<Prestamos> otros2 =helper.getPrestamosmesByTipo3(""+emp.getCid(),mes, anio);
                List<Comisiones> v6= helper.getComisionesmesByTipo(""+emp.getCid(), mes, anio);    
                float empresa= Float.parseFloat(rol.getPrestamo5());
                float quiro=Float.parseFloat(rol.getPrestamo2());
                float comi=Float.parseFloat(rol.getPrestamo1());
                float ext=Float.parseFloat(rol.getPrestamo3());
                float medi=Float.parseFloat(rol.getPrestamo8());
                
                float hipo=Float.parseFloat(rol.getPrestamo4());
                float coop=Float.parseFloat(rol.getPrestamo6());
                float comunes=Float.parseFloat(rol.getPrestamo7());
                prestamo= empresa+quiro+comi+ext+hipo+coop+comunes;
                
                if(ext!=0){
                    if(otros2!=null){
                        ext=ext+Float.parseFloat(otros2.get(0).getValor().replace("-", ""));
                    }
                }
                float totalA=0;
                float sup= Float.parseFloat(rol.getSuplementaria());
                float sup2= Float.parseFloat(rol.getSuplementaria2());
                DecimalFormat df = new DecimalFormat("#.##");
                DecimalFormat df2 = new DecimalFormat("#.##");
                float pago=Float.parseFloat(rol.getSueldo());
                float iess=Float.parseFloat(rol.getIess());
                float fondo=Float.parseFloat(rol.getFondos());
                Image image1 = Image.getInstance(direccion+"logo-mkt.png");
                float bonoss=(bonoa + hora);
                if(otros!=null){
                    bonoss=bonoss-Float.parseFloat(otros.get(0).getValor());
                }
                float desc=  multaa - iess + prestamo;
                
                /*PDF CREATOR*/
                PdfPTable border = new PdfPTable(4);
                PdfPTable border1 = new PdfPTable(2);
                PdfPTable border2 = new PdfPTable(2);
                
                PdfPTable tabla = new PdfPTable(1);
                PdfPCell celda = new PdfPCell();
                image1.scaleAbsolute(60f, 40f);
                celda.setImage(image1);
                celda.setBorder(0);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(3);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo1 = new Paragraph("ROL DE PAGOS INDIVIDUAL",new Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                documento.add(new Paragraph(" "));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(parrafo1);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo2 = new Paragraph("EMPLEADO",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo2a = new Paragraph(emplead.getNombre1()+" "+emplead.getNombre2()+" "+emplead.getApellido1()+" "+emplead.getApellido2(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo2);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo2a);
                border1.addCell(celda);

                
                Calendar ahoraCal = Calendar.getInstance();
                Date fe = new Date();
                ahoraCal.set(Integer.parseInt(anio), mesnum, 1);
                ahoraCal.set(Integer.parseInt(anio), mesnum, ahoraCal.getActualMaximum(Calendar.DAY_OF_MONTH));
                Paragraph parrafo3 = new Paragraph("FECHA",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo3a = new Paragraph(Funcion.DateFormat(ahoraCal.getTime()),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo3);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo3a);
                border2.addCell(celda);

                Paragraph parrafo4 = new Paragraph("CARGO",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo4a = new Paragraph(emplead.getPerfilpuesto(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                Paragraph parrafo41 = new Paragraph("Dias",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo41a = new Paragraph(rol.getDias(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo4);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo4a);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo41);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo41a);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo5 = new Paragraph("INGRESOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo5a = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo5);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);

                Paragraph parrafo6 = new Paragraph("DESCUENTOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo6a = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo6);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo7 = new Paragraph("Sueldo Base",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo7a = new Paragraph("$ "+rol.getSueldo(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                double cmi=0;
                if(v6!=null){
                    for(Comisiones z : v6){
                        cmi = cmi + Double.parseDouble(z.getValor());
                    }
                }
                Paragraph parrafocomi = new Paragraph("Comisiones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafocomia = new Paragraph("$ "+df.format(cmi).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo7);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo7a);
                border1.addCell(celda);
                if(v6!=null){
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafocomi);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafocomia);
                border1.addCell(celda);
                }
                Paragraph parrafo8 = new Paragraph("Aportes IESS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo8a = new Paragraph("$ -"+df.format(iess).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo8);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo8a);
                border2.addCell(celda);

                Paragraph parrafo9 = new Paragraph("Horas Extras",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo9a = new Paragraph("$ "+df2.format(sup2),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo9);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo9a);
                border1.addCell(celda);

                Paragraph parrafo10 = new Paragraph("Préstamos IESS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo10a = new Paragraph("$ "+df2.format(quiro+hipo),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo10);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo10a);
                border2.addCell(celda);

                Paragraph bonos;
                if((sup+Float.parseFloat(rol.getAlimentacion()))<300){
                    bonos = new Paragraph("Alimentación y Transporte",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                }else{
                    bonos = new Paragraph("Alimentación y Viaticos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                }
                Paragraph bonosa = new Paragraph("$ "+df.format(sup+Float.parseFloat(rol.getAlimentacion())+Float.parseFloat(rol.getMobilizacion())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(bonos);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(bonosa);
                border1.addCell(celda);

                Paragraph parrafo12 = new Paragraph("Préstamos Y Anticipos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo12a = new Paragraph("$ "+df.format(empresa+comunes),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo12);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo12a);
                border2.addCell(celda);

                Paragraph parrafo13 = new Paragraph("Bonos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo13a = new Paragraph("$ "+df.format(bonoss),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo13);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo13a);
                border1.addCell(celda);

                Paragraph comisariato = new Paragraph("Comisariato",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph comisariatoa = new Paragraph("$ "+df.format(comi),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(comisariato);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(comisariatoa);
                border2.addCell(celda);
                
                Paragraph fondos = new Paragraph("Fondos de Reserva",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph fondosa = new Paragraph("$ "+df.format(fondo),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                if(fondo!=0){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(fondos);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(fondosa);
                    border1.addCell(celda);
                }
                
                Paragraph parrafo14 = new Paragraph("Multas",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo14a = new Paragraph("$ "+df.format(multaa),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo14);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo14a);
                border2.addCell(celda);
                                /*****************/
                Paragraph vacaciones = new Paragraph("Liq. Vacaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph vacacionesa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getLiquidacion())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                //Vacaciones
                if(!rol.getLiquidacion().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(vacaciones);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(vacacionesa);
                    border1.addCell(celda);
                }
                Paragraph tercero=null;
                Paragraph terceroa=null;
                
                Paragraph tercero2=null;
                Paragraph terceroa2=null;
                if(rol.getCedula().contains("919889006")){
                    tercero = new Paragraph("Decimotercero Septiembre",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    terceroa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimotercero())/2),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    
                    tercero2 = new Paragraph("Decimotercero Agosto",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    terceroa2 = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimotercero())/2),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                }else if(rol.getCedula().contains("917916462")){
                    tercero = new Paragraph("Decimotercero Septiembre",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    terceroa = new Paragraph("$ 38,65",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    
                    tercero2 = new Paragraph("Decimotercero Agosto",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    terceroa2 = new Paragraph("$ 25,77",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                }else{
                    tercero = new Paragraph("Decimotercero Mensual",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    terceroa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimotercero())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                }
                
                if(!rol.getDecimotercero().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(tercero);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(terceroa);
                    border1.addCell(celda);
                    
                    if(tercero2!=null){
                        celda = new PdfPCell();
                        celda.setBorder(0);
                        celda.setPhrase(tercero2);
                        border1.addCell(celda);

                        celda = new PdfPCell();
                        celda.setBorder(0);
                        celda.setHorizontalAlignment(2);
                        celda.setPhrase(terceroa2);
                        border1.addCell(celda);
                    }
                }
                
                Paragraph cuarto=null;
                Paragraph cuartoa=null;
                
                Paragraph cuarto2=null;
                Paragraph cuartoa2=null;
                
                if(rol.getCedula().contains("917916462")){
                    cuarto = new Paragraph("Decimocuarto Septiembre",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    cuartoa = new Paragraph("$ 29,50",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    cuarto2 = new Paragraph("Decimocuarto Agosto",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    cuartoa2 = new Paragraph("$ 19,67",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                }else{
                    cuarto = new Paragraph("Decimocuarto Mensual",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    cuartoa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimocuarto())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                }
                if(!rol.getDecimocuarto().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(cuarto);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(cuartoa);
                    border1.addCell(celda);
                    if(cuarto2!=null){
                        celda = new PdfPCell();
                        celda.setBorder(0);
                        celda.setPhrase(cuarto2);
                        border1.addCell(celda);

                        celda = new PdfPCell();
                        celda.setBorder(0);
                        celda.setHorizontalAlignment(2);
                        celda.setPhrase(cuartoa2);
                        border1.addCell(celda);
                    }
                }
                
                Paragraph excuarto = new Paragraph("Liq. Decimotercero Dic-Jul 2015",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph excuartoa = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(otros!=null){
                    excuartoa = new Paragraph("$ "+df.format(Double.parseDouble(otros.get(0).getValor())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(excuarto);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(excuartoa);
                    border1.addCell(celda);
                }
                
                Paragraph extension = new Paragraph("IESS: Extensión a Cónyuges",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona = new Paragraph("$ "+df.format(ext),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(ext!=0){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona);
                    border2.addCell(celda);

                }
                
                Paragraph extension2 = new Paragraph("Anticipo por Vacaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona2 = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(otros2!=null){
                    Float fl = Float.parseFloat(otros2.get(0).getValor().replace("-", ""));
                    extensiona2 = new Paragraph("$ -"+df.format(fl),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension2);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona2);
                    border2.addCell(celda);
                }
                
                
                celda= new PdfPCell(border1);
                celda.setBorder(0);
                celda.setColspan(2);
                border.addCell(celda);
                
                celda= new PdfPCell(border2);
                celda.setBorder(0);
                celda.setColspan(2);
                border.addCell(celda);
                
                
                Paragraph parrafo15 = new Paragraph("TOTAL INGRESOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                if(otros!=null){
                    bonoss=bonoss+Float.parseFloat(otros.get(0).getValor());
                }
                float liq= Float.parseFloat(rol.getLiquidacion());
                Float n = Float.parseFloat(rol.getSueldo()) + liq +bonoss + fondo +sup +sup2+Float.parseFloat(rol.getDecimotercero())+Float.parseFloat(rol.getDecimocuarto())+Float.parseFloat(rol.getAlimentacion())+Float.parseFloat(rol.getComisiones())+Float.parseFloat(rol.getMobilizacion());
                Paragraph parrafo15a = new Paragraph("$ "+df.format(n),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo15);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo15a);
                border.addCell(celda);
                
                
                Paragraph parrafo16 = new Paragraph("TOTAL DESCUENTOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo16a = new Paragraph("$ "+df.format(desc).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 6, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo16);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo16a);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);


                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo17 = new Paragraph("NETO A PAGAR",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo17a = new Paragraph("$ "+rol.getTotal(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo17);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo17a);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo22 = new Paragraph("______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo22);
                border.addCell(celda);

                Paragraph parrafo18 = new Paragraph("______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo18);
                border.addCell(celda);

                Paragraph parrafo21 = new Paragraph("Emitido Por",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo21);
                border.addCell(celda);

                Paragraph parrafo19 = new Paragraph("RECIBÍ CONFORME",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo19);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo20 = new Paragraph("C.I. ______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo20);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);
                Paragraph parrafo23 = new Paragraph("Observaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                if(v6!=null){
                            celda = new PdfPCell();
                            celda.setBorder(0);
                            celda.setColspan(1);
                            celda.setPhrase(parrafo23);
                            border.addCell(celda);
                            
                            celda = new PdfPCell();
                            celda.setBorder(0);
                            celda.setColspan(3);
                            celda.setHorizontalAlignment(1);
                            celda.setPhrase(new Phrase(""));
                            border.addCell(celda);
                            
                            for(Comisiones r: v6){
                                celda = new PdfPCell();
                                celda.setBorder(0);
                                celda.setColspan(4);
                                celda.setPhrase(new Paragraph(r.getDetalle() +"por el valor de: $"+r.getValor(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0))));
                                border.addCell(celda);
                            }
                        }
                
                PdfPCell bord2 = new PdfPCell();
                bord2.setBorder(1);
                bord2= new PdfPCell(border);

                tabla.addCell(bord2);
                documento.add(tabla);
            }
            }
            }
            documento.close();
            helper.cerrarSesion();
        }catch(Exception ex){
            System.out.println(emplead.getApellido1());
            documento.close();
        }
        
    }
    
    public void pdftotaleljuri(String mes, String anio, String dire){
        //String imagepath = Server.MapPath("Images");
        Document documento = new Document();
        float hora=0;
        float prestamo=0;
        float bonoa=0;
        float multaa=0;
        int mesnum=0;
        String[] fecha= {"Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"};
        for(int i=0; i<12;i++){
            if(fecha[i].equalsIgnoreCase(mes)){
                mesnum=i;
            }
        }
        FileOutputStream ficheroPdf=null;
        
        try
        {
            ficheroPdf = new FileOutputStream(dire+"\\"+mes+anio+"CajamarcaEljuri.pdf");
//            ficheroPdf = new FileOutputStream("C:\\Users\\Matheus\\Desktop\\pruebas\\"+mes+anio+"Cajamarca.pdf");
            PdfWriter.getInstance(documento,ficheroPdf).setInitialLeading(20);
        }
        catch (FileNotFoundException | DocumentException ex)
        {
            System.out.println(ex.toString());
        }
        Empleado emplead = null;
        String cadena="";
        try{
            ServiceHb helper = new ServiceHb();
            helper.iniciarTransaccion();
            documento.open();
            List<Roles> roles=helper.getRolesgenerales(mes, anio);
            int temp=0;
            int tempt=roles.size();
            for(Roles rol : roles){
                cadena=rol.getCi();
                temp++;
                System.out.println(temp+"/"+tempt);
                if(temp==129){
                    System.out.println("");
                }
                bonoa= Float.parseFloat(rol.getBon());
                multaa= Float.parseFloat(rol.getMultas());
                hora = Float.parseFloat(rol.getReposiciones());
                if(isNumeric(rol.getCi())){
                    emplead = helper.getPersonasCid2((rol.getCi()));
                    if(emplead==null){
                        emplead = helper.getPersonasCid((rol.getCi()));
                    }
                }else{
                    emplead = helper.getPersonasCid((rol.getCi()));
                }
                if(emplead!=null){
                if(emplead.getDeptEmpl().getDepartamento().getNombre().equalsIgnoreCase("Seguridad Fisica")&&emplead.getCiudad().contains("Juan Eljuri")){
                emp=emplead;
                List<Bono> otros =helper.getBonomesByTipo3(""+emp.getCid(),mes, anio);
                List<Prestamos> otros2 =helper.getPrestamosmesByTipo3(""+emp.getCid(),mes, anio);
                List<Comisiones> v6= helper.getComisionesmesByTipo(""+emp.getCid(), mes, anio);    
                float empresa= Float.parseFloat(rol.getPrestamo5());
                float quiro=Float.parseFloat(rol.getPrestamo2());
                float comi=Float.parseFloat(rol.getPrestamo1());
                float ext=Float.parseFloat(rol.getPrestamo3());
                float medi=Float.parseFloat(rol.getPrestamo8());
                float hipo=Float.parseFloat(rol.getPrestamo4());
                float coop=Float.parseFloat(rol.getPrestamo6());
                float comunes=Float.parseFloat(rol.getPrestamo7());
                prestamo= empresa+quiro+comi+ext+hipo+coop+comunes;
                
                if(ext!=0){
                    if(otros2!=null){
                        ext=ext+Float.parseFloat(otros2.get(0).getValor().replace("-", ""));
                    }
                }
                float totalA=0;
                float sup= Float.parseFloat(rol.getSuplementaria());
                float sup2= Float.parseFloat(rol.getSuplementaria2());
                DecimalFormat df = new DecimalFormat("#.##");
                DecimalFormat df2 = new DecimalFormat("#.##");
                float pago=Float.parseFloat(rol.getSueldo());
                float iess=Float.parseFloat(rol.getIess());
                float fondo=Float.parseFloat(rol.getFondos());
                Image image1 = Image.getInstance(direccion+"logo-mkt.png");
                float bonoss=(bonoa + hora);
                if(otros!=null){
                    bonoss=bonoss-Float.parseFloat(otros.get(0).getValor());
                }
                float desc=  multaa - iess + prestamo;
                
                /*PDF CREATOR*/
                PdfPTable border = new PdfPTable(4);
                PdfPTable border1 = new PdfPTable(2);
                PdfPTable border2 = new PdfPTable(2);
                
                PdfPTable tabla = new PdfPTable(1);
                PdfPCell celda = new PdfPCell();
                image1.scaleAbsolute(60f, 40f);
                celda.setImage(image1);
                celda.setBorder(0);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(3);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo1 = new Paragraph("ROL DE PAGOS INDIVIDUAL",new Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                documento.add(new Paragraph(" "));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(parrafo1);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo2 = new Paragraph("EMPLEADO",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo2a = new Paragraph(emplead.getNombre1()+" "+emplead.getNombre2()+" "+emplead.getApellido1()+" "+emplead.getApellido2(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo2);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo2a);
                border1.addCell(celda);

                
                Calendar ahoraCal = Calendar.getInstance();
                Date fe = new Date();
                ahoraCal.set(Integer.parseInt(anio), mesnum, 1);
                ahoraCal.set(Integer.parseInt(anio), mesnum, ahoraCal.getActualMaximum(Calendar.DAY_OF_MONTH));
                Paragraph parrafo3 = new Paragraph("FECHA",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo3a = new Paragraph(Funcion.DateFormat(ahoraCal.getTime()),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo3);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo3a);
                border2.addCell(celda);

                Paragraph parrafo4 = new Paragraph("CARGO",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo4a = new Paragraph(emplead.getPerfilpuesto(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                Paragraph parrafo41 = new Paragraph("Dias",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo41a = new Paragraph(rol.getDias(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo4);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo4a);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo41);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo41a);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo5 = new Paragraph("INGRESOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo5a = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo5);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);

                Paragraph parrafo6 = new Paragraph("DESCUENTOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo6a = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo6);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo7 = new Paragraph("Sueldo Base",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo7a = new Paragraph("$ "+rol.getSueldo(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                double cmi=0;
                if(v6!=null){
                    for(Comisiones z : v6){
                        cmi = cmi + Double.parseDouble(z.getValor());
                    }
                }
                Paragraph parrafocomi = new Paragraph("Comisiones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafocomia = new Paragraph("$ "+df.format(cmi).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo7);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo7a);
                border1.addCell(celda);
                if(v6!=null){
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafocomi);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafocomia);
                border1.addCell(celda);
                }
                Paragraph parrafo8 = new Paragraph("Aportes IESS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo8a = new Paragraph("$ -"+df.format(iess).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo8);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo8a);
                border2.addCell(celda);

                Paragraph parrafo9 = new Paragraph("Horas Extras",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo9a = new Paragraph("$ "+df2.format(sup2),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo9);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo9a);
                border1.addCell(celda);

                Paragraph parrafo10 = new Paragraph("Préstamos IESS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo10a = new Paragraph("$ "+df2.format(quiro+hipo),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo10);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo10a);
                border2.addCell(celda);

                Paragraph bonos;
                if((sup+Float.parseFloat(rol.getAlimentacion()))<300){
                    bonos = new Paragraph("Alimentación y Transporte",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                }else{
                    bonos = new Paragraph("Alimentación y Viaticos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                }
                Paragraph bonosa = new Paragraph("$ "+df.format(sup+Float.parseFloat(rol.getAlimentacion())+Float.parseFloat(rol.getMobilizacion())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(bonos);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(bonosa);
                border1.addCell(celda);

                Paragraph parrafo12 = new Paragraph("Préstamos Y Anticipos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo12a = new Paragraph("$ "+df.format(empresa+comunes),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo12);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo12a);
                border2.addCell(celda);

                Paragraph parrafo13 = new Paragraph("Bonos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo13a = new Paragraph("$ "+df.format(bonoss),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo13);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo13a);
                border1.addCell(celda);

                Paragraph comisariato = new Paragraph("Comisariato",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph comisariatoa = new Paragraph("$ "+df.format(comi),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(comisariato);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(comisariatoa);
                border2.addCell(celda);
                
                Paragraph fondos = new Paragraph("Fondos de Reserva",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph fondosa = new Paragraph("$ "+df.format(fondo),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                if(fondo!=0){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(fondos);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(fondosa);
                    border1.addCell(celda);
                }
                
                Paragraph parrafo14 = new Paragraph("Multas",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo14a = new Paragraph("$ "+df.format(multaa),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo14);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo14a);
                border2.addCell(celda);
                                /*****************/
                Paragraph vacaciones = new Paragraph("Liq. Vacaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph vacacionesa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getLiquidacion())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                //Vacaciones
                if(!rol.getLiquidacion().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(vacaciones);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(vacacionesa);
                    border1.addCell(celda);
                }

                Paragraph tercero = new Paragraph("Decimotercero Mensual",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph terceroa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimotercero())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                
                if(!rol.getDecimotercero().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(tercero);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(terceroa);
                    border1.addCell(celda);
                }
                
                Paragraph cuarto = new Paragraph("Decimocuarto Mensual",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph cuartoa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimocuarto())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(!rol.getDecimocuarto().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(cuarto);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(cuartoa);
                    border1.addCell(celda);
                }
                
                Paragraph excuarto = new Paragraph("Liq. Decimotercero Dic-Jul 2015",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph excuartoa = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(otros!=null){
                    excuartoa = new Paragraph("$ "+df.format(Double.parseDouble(otros.get(0).getValor())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(excuarto);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(excuartoa);
                    border1.addCell(celda);
                }
                
                Paragraph extension = new Paragraph("IESS: Extensión a Cónyuges",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona = new Paragraph("$ "+df.format(ext),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(ext!=0){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona);
                    border2.addCell(celda);

                }
                
                Paragraph extension23 = new Paragraph("Medilink",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona23 = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                if(medi!=0){
                    Float fl = Float.parseFloat(rol.getPrestamo8().replace("-", ""));
                    extensiona23 = new Paragraph("$ -"+df.format(fl),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension23);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona23);
                    border2.addCell(celda);
                }
                
                Paragraph extension2 = new Paragraph("Anticipo por Vacaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona2 = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(otros2!=null){
                    Float fl = Float.parseFloat(otros2.get(0).getValor().replace("-", ""));
                    extensiona2 = new Paragraph("$ -"+df.format(fl),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension2);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona2);
                    border2.addCell(celda);
                }
                
                celda= new PdfPCell(border1);
                celda.setBorder(0);
                celda.setColspan(2);
                border.addCell(celda);
                
                celda= new PdfPCell(border2);
                celda.setBorder(0);
                celda.setColspan(2);
                border.addCell(celda);
                
                Paragraph parrafo15 = new Paragraph("TOTAL INGRESOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                if(otros!=null){
                    bonoss=bonoss+Float.parseFloat(otros.get(0).getValor());
                }
                float liq= Float.parseFloat(rol.getLiquidacion());
                Float n = Float.parseFloat(rol.getSueldo()) + liq +bonoss + fondo +sup +sup2+Float.parseFloat(rol.getDecimotercero())+Float.parseFloat(rol.getDecimocuarto())+Float.parseFloat(rol.getAlimentacion())+Float.parseFloat(rol.getComisiones())+Float.parseFloat(rol.getMobilizacion());
                Paragraph parrafo15a = new Paragraph("$ "+df.format(n),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo15);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo15a);
                border.addCell(celda);
                
                
                Paragraph parrafo16 = new Paragraph("TOTAL DESCUENTOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo16a = new Paragraph("$ "+df.format(desc).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 6, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo16);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo16a);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);


                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo17 = new Paragraph("NETO A PAGAR",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo17a = new Paragraph("$ "+rol.getTotal(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo17);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo17a);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo22 = new Paragraph("______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo22);
                border.addCell(celda);

                Paragraph parrafo18 = new Paragraph("______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo18);
                border.addCell(celda);

                Paragraph parrafo21 = new Paragraph("Emitido Por",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo21);
                border.addCell(celda);

                Paragraph parrafo19 = new Paragraph("RECIBÍ CONFORME",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo19);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo20 = new Paragraph("C.I. ______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo20);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);
                Paragraph parrafo23 = new Paragraph("Observaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                if(v6!=null){
                            celda = new PdfPCell();
                            celda.setBorder(0);
                            celda.setColspan(1);
                            celda.setPhrase(parrafo23);
                            border.addCell(celda);
                            
                            celda = new PdfPCell();
                            celda.setBorder(0);
                            celda.setColspan(3);
                            celda.setHorizontalAlignment(1);
                            celda.setPhrase(new Phrase(""));
                            border.addCell(celda);
                            
                            for(Comisiones r: v6){
                                celda = new PdfPCell();
                                celda.setBorder(0);
                                celda.setColspan(4);
                                celda.setPhrase(new Paragraph(r.getDetalle() +"por el valor de: $"+r.getValor(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0))));
                                border.addCell(celda);
                            }
                        }
                
                PdfPCell bord2 = new PdfPCell();
                bord2.setBorder(1);
                bord2= new PdfPCell(border);

                tabla.addCell(bord2);
                documento.add(tabla);
            }
            }
            }
            documento.close();
            helper.cerrarSesion();
        }catch(Exception ex){
            System.out.println(emplead.getApellido1());
            documento.close();
        }
        
    }
    
    
    public void pdftotaltrebol(String mes, String anio, String dire){
        //String imagepath = Server.MapPath("Images");
        Document documento = new Document();
        float hora=0;
        float prestamo=0;
        float bonoa=0;
        float multaa=0;
        int mesnum=0;
        String[] fecha= {"Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"};
        for(int i=0; i<12;i++){
            if(fecha[i].equalsIgnoreCase(mes)){
                mesnum=i;
            }
        }
        FileOutputStream ficheroPdf=null;
        
        try
        {
            ficheroPdf = new FileOutputStream(dire+"\\"+mes+anio+"CajamarcaTrebol.pdf");
//            ficheroPdf = new FileOutputStream("C:\\Users\\Matheus\\Desktop\\pruebas\\"+mes+anio+"Cajamarca.pdf");
            PdfWriter.getInstance(documento,ficheroPdf).setInitialLeading(20);
        }
        catch (FileNotFoundException | DocumentException ex)
        {
            System.out.println(ex.toString());
        }
        Empleado emplead = null;
        String cadena="";
        try{
            ServiceHb helper = new ServiceHb();
            helper.iniciarTransaccion();
            documento.open();
            List<Roles> roles=helper.getRolesgenerales(mes, anio);
            int temp=0;
            int tempt=roles.size();
            for(Roles rol : roles){
                cadena=rol.getCi();
                temp++;
                System.out.println(temp+"/"+tempt);
                if(temp==129){
                    System.out.println("");
                }
                bonoa= Float.parseFloat(rol.getBon());
                multaa= Float.parseFloat(rol.getMultas());
                hora = Float.parseFloat(rol.getReposiciones());
                if(isNumeric(rol.getCi())){
                    emplead = helper.getPersonasCid2((rol.getCi()));
                    if(emplead==null){
                        emplead = helper.getPersonasCid((rol.getCi()));
                    }
                }else{
                    emplead = helper.getPersonasCid((rol.getCi()));
                }
                if(emplead!=null){
                if(emplead.getDeptEmpl().getDepartamento().getNombre().equalsIgnoreCase("Seguridad Fisica")&&emplead.getCiudad().contains("Trebol Verde")){
                emp=emplead;
                List<Bono> otros =helper.getBonomesByTipo3(""+emp.getCid(),mes, anio);
                List<Prestamos> otros2 =helper.getPrestamosmesByTipo3(""+emp.getCid(),mes, anio);
                List<Comisiones> v6= helper.getComisionesmesByTipo(""+emp.getCid(), mes, anio);    
                float empresa= Float.parseFloat(rol.getPrestamo5());
                float quiro=Float.parseFloat(rol.getPrestamo2());
                float comi=Float.parseFloat(rol.getPrestamo1());
                float ext=Float.parseFloat(rol.getPrestamo3());
                float medi=Float.parseFloat(rol.getPrestamo8());
                float hipo=Float.parseFloat(rol.getPrestamo4());
                float coop=Float.parseFloat(rol.getPrestamo6());
                float comunes=Float.parseFloat(rol.getPrestamo7());
                prestamo= empresa+quiro+comi+ext+hipo+coop+comunes;
                
                if(ext!=0){
                    if(otros2!=null){
                        ext=ext+Float.parseFloat(otros2.get(0).getValor().replace("-", ""));
                    }
                }
                float totalA=0;
                float sup= Float.parseFloat(rol.getSuplementaria());
                float sup2= Float.parseFloat(rol.getSuplementaria2());
                DecimalFormat df = new DecimalFormat("#.##");
                DecimalFormat df2 = new DecimalFormat("#.##");
                float pago=Float.parseFloat(rol.getSueldo());
                float iess=Float.parseFloat(rol.getIess());
                float fondo=Float.parseFloat(rol.getFondos());
                Image image1 = Image.getInstance(direccion+"logo-mkt.png");
                float bonoss=(bonoa + hora);
                if(otros!=null){
                    bonoss=bonoss-Float.parseFloat(otros.get(0).getValor());
                }
                float desc=  multaa - iess + prestamo;
                
                /*PDF CREATOR*/
                PdfPTable border = new PdfPTable(4);
                PdfPTable border1 = new PdfPTable(2);
                PdfPTable border2 = new PdfPTable(2);
                
                PdfPTable tabla = new PdfPTable(1);
                PdfPCell celda = new PdfPCell();
                image1.scaleAbsolute(60f, 40f);
                celda.setImage(image1);
                celda.setBorder(0);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(3);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo1 = new Paragraph("ROL DE PAGOS INDIVIDUAL",new Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                documento.add(new Paragraph(" "));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(parrafo1);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo2 = new Paragraph("EMPLEADO",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo2a = new Paragraph(emplead.getNombre1()+" "+emplead.getNombre2()+" "+emplead.getApellido1()+" "+emplead.getApellido2(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo2);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo2a);
                border1.addCell(celda);

                
                Calendar ahoraCal = Calendar.getInstance();
                Date fe = new Date();
                ahoraCal.set(Integer.parseInt(anio), mesnum, 1);
                ahoraCal.set(Integer.parseInt(anio), mesnum, ahoraCal.getActualMaximum(Calendar.DAY_OF_MONTH));
                Paragraph parrafo3 = new Paragraph("FECHA",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo3a = new Paragraph(Funcion.DateFormat(ahoraCal.getTime()),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo3);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo3a);
                border2.addCell(celda);

                Paragraph parrafo4 = new Paragraph("CARGO",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo4a = new Paragraph(emplead.getPerfilpuesto(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                Paragraph parrafo41 = new Paragraph("Dias",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo41a = new Paragraph(rol.getDias(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo4);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo4a);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo41);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo41a);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo5 = new Paragraph("INGRESOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo5a = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo5);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);

                Paragraph parrafo6 = new Paragraph("DESCUENTOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo6a = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo6);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo7 = new Paragraph("Sueldo Base",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo7a = new Paragraph("$ "+rol.getSueldo(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                double cmi=0;
                if(v6!=null){
                    for(Comisiones z : v6){
                        cmi = cmi + Double.parseDouble(z.getValor());
                    }
                }
                Paragraph parrafocomi = new Paragraph("Comisiones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafocomia = new Paragraph("$ "+df.format(cmi).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo7);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo7a);
                border1.addCell(celda);
                if(v6!=null){
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafocomi);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafocomia);
                border1.addCell(celda);
                }
                Paragraph parrafo8 = new Paragraph("Aportes IESS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo8a = new Paragraph("$ -"+df.format(iess).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo8);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo8a);
                border2.addCell(celda);

                Paragraph parrafo9 = new Paragraph("Horas Extras",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo9a = new Paragraph("$ "+df2.format(sup2),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo9);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo9a);
                border1.addCell(celda);

                Paragraph parrafo10 = new Paragraph("Préstamos IESS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo10a = new Paragraph("$ "+df2.format(quiro+hipo),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo10);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo10a);
                border2.addCell(celda);

                Paragraph bonos;
                if((sup+Float.parseFloat(rol.getAlimentacion()))<300){
                    bonos = new Paragraph("Alimentación y Transporte",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                }else{
                    bonos = new Paragraph("Alimentación y Viaticos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                }
                Paragraph bonosa = new Paragraph("$ "+df.format(sup+Float.parseFloat(rol.getAlimentacion())+Float.parseFloat(rol.getMobilizacion())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(bonos);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(bonosa);
                border1.addCell(celda);

                Paragraph parrafo12 = new Paragraph("Préstamos Y Anticipos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo12a = new Paragraph("$ "+df.format(empresa+comunes),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo12);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo12a);
                border2.addCell(celda);

                Paragraph parrafo13 = new Paragraph("Bonos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo13a = new Paragraph("$ "+df.format(bonoss),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo13);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo13a);
                border1.addCell(celda);

                Paragraph comisariato = new Paragraph("Comisariato",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph comisariatoa = new Paragraph("$ "+df.format(comi),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(comisariato);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(comisariatoa);
                border2.addCell(celda);
                
                Paragraph fondos = new Paragraph("Fondos de Reserva",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph fondosa = new Paragraph("$ "+df.format(fondo),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                if(fondo!=0){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(fondos);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(fondosa);
                    border1.addCell(celda);
                }
                
                Paragraph parrafo14 = new Paragraph("Multas",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo14a = new Paragraph("$ "+df.format(multaa),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo14);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo14a);
                border2.addCell(celda);
                                /*****************/
                Paragraph vacaciones = new Paragraph("Liq. Vacaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph vacacionesa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getLiquidacion())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                //Vacaciones
                if(!rol.getLiquidacion().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(vacaciones);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(vacacionesa);
                    border1.addCell(celda);
                }

                Paragraph tercero=null;
                Paragraph terceroa=null;
                
                Paragraph tercero2=null;
                Paragraph terceroa2=null;
                if(rol.getCedula().contains("919889006")){
                    tercero = new Paragraph("Decimotercero Septiembre",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    terceroa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimotercero())/2),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    
                    tercero2 = new Paragraph("Decimotercero Agosto",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    terceroa2 = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimotercero())/2),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                }else if(rol.getCedula().contains("917916462")){
                    tercero = new Paragraph("Decimotercero Septiembre",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    terceroa = new Paragraph("$ 38,65",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    
                    tercero2 = new Paragraph("Decimotercero Agosto",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    terceroa2 = new Paragraph("$ 25,77",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                }else{
                    tercero = new Paragraph("Decimotercero Mensual",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    terceroa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimotercero())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                }
                
                if(!rol.getDecimotercero().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(tercero);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(terceroa);
                    border1.addCell(celda);
                    
                    if(tercero2!=null){
                        celda = new PdfPCell();
                        celda.setBorder(0);
                        celda.setPhrase(tercero2);
                        border1.addCell(celda);

                        celda = new PdfPCell();
                        celda.setBorder(0);
                        celda.setHorizontalAlignment(2);
                        celda.setPhrase(terceroa2);
                        border1.addCell(celda);
                    }
                }
                
                Paragraph cuarto=null;
                Paragraph cuartoa=null;
                
                Paragraph cuarto2=null;
                Paragraph cuartoa2=null;
                
                if(rol.getCedula().contains("917916462")){
                    cuarto = new Paragraph("Decimocuarto Septiembre",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    cuartoa = new Paragraph("$ 29,50",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    cuarto2 = new Paragraph("Decimocuarto Agosto",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    cuartoa2 = new Paragraph("$ 19,67",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                }else{
                    cuarto = new Paragraph("Decimocuarto Mensual",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                    cuartoa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimocuarto())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                }
                if(!rol.getDecimocuarto().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(cuarto);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(cuartoa);
                    border1.addCell(celda);
                    if(cuarto2!=null){
                        celda = new PdfPCell();
                        celda.setBorder(0);
                        celda.setPhrase(cuarto2);
                        border1.addCell(celda);

                        celda = new PdfPCell();
                        celda.setBorder(0);
                        celda.setHorizontalAlignment(2);
                        celda.setPhrase(cuartoa2);
                        border1.addCell(celda);
                    }
                }
                
                Paragraph excuarto = new Paragraph("Liq. Decimotercero Dic-Jul 2015",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph excuartoa = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(otros!=null){
                    excuartoa = new Paragraph("$ "+df.format(Double.parseDouble(otros.get(0).getValor())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(excuarto);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(excuartoa);
                    border1.addCell(celda);
                }
                
                Paragraph extension = new Paragraph("IESS: Extensión a Cónyuges",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona = new Paragraph("$ "+df.format(ext),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(ext!=0){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona);
                    border2.addCell(celda);

                }
                Paragraph extension23 = new Paragraph("Medilink",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona23 = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                if(medi!=0){
                    Float fl = Float.parseFloat(rol.getPrestamo8().replace("-", ""));
                    extensiona23 = new Paragraph("$ -"+df.format(fl),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension23);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona23);
                    border2.addCell(celda);
                }
                Paragraph extension2 = new Paragraph("Anticipo por Vacaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona2 = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(otros2!=null){
                    Float fl = Float.parseFloat(otros2.get(0).getValor().replace("-", ""));
                    extensiona2 = new Paragraph("$ -"+df.format(fl),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension2);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona2);
                    border2.addCell(celda);
                }
                
                celda= new PdfPCell(border1);
                celda.setBorder(0);
                celda.setColspan(2);
                border.addCell(celda);
                
                celda= new PdfPCell(border2);
                celda.setBorder(0);
                celda.setColspan(2);
                border.addCell(celda);
                
                Paragraph parrafo15 = new Paragraph("TOTAL INGRESOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                if(otros!=null){
                    bonoss=bonoss+Float.parseFloat(otros.get(0).getValor());
                }
                float liq= Float.parseFloat(rol.getLiquidacion());
                Float n = Float.parseFloat(rol.getSueldo()) + liq +bonoss + fondo +sup +sup2+Float.parseFloat(rol.getDecimotercero())+Float.parseFloat(rol.getDecimocuarto())+Float.parseFloat(rol.getAlimentacion())+Float.parseFloat(rol.getComisiones())+Float.parseFloat(rol.getMobilizacion());
                Paragraph parrafo15a = new Paragraph("$ "+df.format(n),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo15);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo15a);
                border.addCell(celda);
                
                
                Paragraph parrafo16 = new Paragraph("TOTAL DESCUENTOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo16a = new Paragraph("$ "+df.format(desc).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 6, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo16);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo16a);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);


                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo17 = new Paragraph("NETO A PAGAR",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo17a = new Paragraph("$ "+rol.getTotal(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo17);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo17a);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo22 = new Paragraph("______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo22);
                border.addCell(celda);

                Paragraph parrafo18 = new Paragraph("______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo18);
                border.addCell(celda);

                Paragraph parrafo21 = new Paragraph("Emitido Por",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo21);
                border.addCell(celda);

                Paragraph parrafo19 = new Paragraph("RECIBÍ CONFORME",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo19);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo20 = new Paragraph("C.I. ______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo20);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);
                Paragraph parrafo23 = new Paragraph("Observaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                if(v6!=null){
                            celda = new PdfPCell();
                            celda.setBorder(0);
                            celda.setColspan(1);
                            celda.setPhrase(parrafo23);
                            border.addCell(celda);
                            
                            celda = new PdfPCell();
                            celda.setBorder(0);
                            celda.setColspan(3);
                            celda.setHorizontalAlignment(1);
                            celda.setPhrase(new Phrase(""));
                            border.addCell(celda);
                            
                            for(Comisiones r: v6){
                                celda = new PdfPCell();
                                celda.setBorder(0);
                                celda.setColspan(4);
                                celda.setPhrase(new Paragraph(r.getDetalle() +"por el valor de: $"+r.getValor(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0))));
                                border.addCell(celda);
                            }
                        }
                
                PdfPCell bord2 = new PdfPCell();
                bord2.setBorder(1);
                bord2= new PdfPCell(border);

                tabla.addCell(bord2);
                documento.add(tabla);
            }
            }
            }
            documento.close();
            helper.cerrarSesion();
        }catch(Exception ex){
            System.out.println(emplead.getApellido1());
            documento.close();
        }
        
    }
    
    
    public JTextField getjTextField1() {
        return jTextField1;
    }

    public void setjTextField1(JTextField jTextField1) {
        this.jTextField1 = jTextField1;
    }
    
    private static boolean isNumeric(String cadena){
	try {
		Integer.parseInt(cadena);
		return true;
	} catch (NumberFormatException nfe){
		return false;
	}
}
    public void pdftotalindividual(String mes, String anio, String direccion, String ci,String nombre,String dir){
        //String imagepath = Server.MapPath("Images");
        Document documento = new Document();
        float hora=0;
        float prestamo=0;
        float bonoa=0;
        float multaa=0;
        int mesnum=0;
        String[] fecha= {"Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"};
        for(int i=0; i<12;i++){
            if(fecha[i].equalsIgnoreCase(mes)){
                mesnum=i;
            }
        }
        FileOutputStream ficheroPdf;
        
        try
        {
            if(carpeta==1){
                ficheroPdf = new FileOutputStream(dir+"\\"+mes+anio+ci+".pdf");
            }else{
                ficheroPdf = new FileOutputStream(dir+"\\"+mes+anio+ci+nombre+".pdf");
            }
            PdfWriter.getInstance(documento,ficheroPdf).setInitialLeading(20);
        }
        catch (FileNotFoundException | DocumentException ex)
        {
            System.out.println(ex.toString());
        }
        Empleado emplead = null;
        try{
            ServiceHb helper = new ServiceHb();
            helper.iniciarTransaccion();
            documento.open();
            List<Roles> roles=helper.getRolesmesByTipo(""+ci,mes, anio);
            for(Roles rol : roles){
                bonoa= Float.parseFloat(rol.getBon());
                multaa= Float.parseFloat(rol.getMultas());
                hora = Float.parseFloat(rol.getReposiciones());
                if(isNumeric(rol.getCi())){
                    emplead = helper.getPersonasCid2((rol.getCi()));
                    if(emplead==null){
                        emplead = helper.getPersonasCid((rol.getCi()));
                    }
                }else{
                    emplead = helper.getPersonasCid((rol.getCi()));
                }
                emp=emplead;
                List<Bono> otros =helper.getBonomesByTipo3(""+emp.getCid(),mes, anio);
                List<Prestamos> otros2 =helper.getPrestamosmesByTipo3(""+emp.getCid(),mes, anio);
                List<Comisiones> v6= helper.getComisionesmesByTipo(""+emp.getCid(), mes, anio);    
                float empresa= Float.parseFloat(rol.getPrestamo5());
                float quiro=Float.parseFloat(rol.getPrestamo2());
                float comi=Float.parseFloat(rol.getPrestamo1());
                float ext=Float.parseFloat(rol.getPrestamo3());
                float medi=Float.parseFloat(rol.getPrestamo8());
                
                float hipo=Float.parseFloat(rol.getPrestamo4());
                float coop=Float.parseFloat(rol.getPrestamo6());
                float comunes=Float.parseFloat(rol.getPrestamo7());
                if(ext==medi){ext=0;}
                prestamo= empresa+quiro+comi+ext+hipo+coop+comunes+medi;
                
                if(ext!=0){
                    if(otros2!=null){
                        ext=ext+Float.parseFloat(otros2.get(0).getValor().replace("-", ""));
                    }
                }
                float totalA=0;
                float sup= Float.parseFloat(rol.getSuplementaria());
                float sup2= Float.parseFloat(rol.getSuplementaria2());
                DecimalFormat df = new DecimalFormat("#.##");
                DecimalFormat df2 = new DecimalFormat("#.##");
                float pago=Float.parseFloat(rol.getSueldo());
                float iess=Float.parseFloat(rol.getIess());
                float fondo=Float.parseFloat(rol.getFondos());
                Image image1 = Image.getInstance(direccion+"logo-mkt.png");
                float bonoss=(bonoa + hora);
                if(otros!=null){
                    bonoss=bonoss-Float.parseFloat(otros.get(0).getValor());
                }
                float desc=  multaa - iess + prestamo;
                
                /*PDF CREATOR*/
                PdfPTable border = new PdfPTable(4);
                PdfPTable border1 = new PdfPTable(2);
                PdfPTable border2 = new PdfPTable(2);
                
                PdfPTable tabla = new PdfPTable(1);
                PdfPCell celda = new PdfPCell();
                image1.scaleAbsolute(60f, 40f);
                celda.setImage(image1);
                celda.setBorder(0);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(3);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo1 = new Paragraph("ROL DE PAGOS INDIVIDUAL",new Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                documento.add(new Paragraph(" "));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(parrafo1);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo2 = new Paragraph("EMPLEADO",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo2a = new Paragraph(emplead.getNombre1()+" "+emplead.getNombre2()+" "+emplead.getApellido1()+" "+emplead.getApellido2(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo2);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo2a);
                border1.addCell(celda);

                
                Calendar ahoraCal = Calendar.getInstance();
                Date fe = new Date();
                ahoraCal.set(Integer.parseInt(anio), mesnum, 1);
                ahoraCal.set(Integer.parseInt(anio), mesnum, ahoraCal.getActualMaximum(Calendar.DAY_OF_MONTH));
                Paragraph parrafo3 = new Paragraph("FECHA",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo3a = new Paragraph(Funcion.DateFormat(ahoraCal.getTime()),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo3);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo3a);
                border2.addCell(celda);

                Paragraph parrafo4 = new Paragraph("CARGO",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo4a = new Paragraph(emplead.getPerfilpuesto(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                Paragraph parrafo41 = new Paragraph("Dias",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo41a = new Paragraph(rol.getDias(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo4);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo4a);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo41);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo41a);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo5 = new Paragraph("INGRESOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo5a = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo5);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);

                Paragraph parrafo6 = new Paragraph("DESCUENTOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo6a = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo6);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo7 = new Paragraph("Sueldo Base",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo7a = new Paragraph("$ "+rol.getSueldo(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                double cmi=0;
                if(v6!=null){
                    for(Comisiones z : v6){
                        cmi = cmi + Double.parseDouble(z.getValor());
                    }
                }
                Paragraph parrafocomi = new Paragraph("Comisiones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafocomia = new Paragraph("$ "+df.format(cmi).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo7);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo7a);
                border1.addCell(celda);
                if(v6!=null){
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafocomi);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafocomia);
                border1.addCell(celda);
                }
                Paragraph parrafo8 = new Paragraph("Aportes IESS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo8a = new Paragraph("$ -"+df.format(iess).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo8);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo8a);
                border2.addCell(celda);

                Paragraph parrafo9 = new Paragraph("Horas Extras",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo9a = new Paragraph("$ "+df2.format(sup2),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo9);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo9a);
                border1.addCell(celda);

                Paragraph parrafo10 = new Paragraph("Préstamos IESS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo10a = new Paragraph("$ "+df2.format(quiro+hipo),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo10);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo10a);
                border2.addCell(celda);

                Paragraph bonos;
                if((sup+Float.parseFloat(rol.getAlimentacion()))<300){
                    bonos = new Paragraph("Alimentación y Transporte",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                }else{
                    bonos = new Paragraph("Alimentación y Viaticos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                }
                Paragraph bonosa = new Paragraph("$ "+df.format(sup+Float.parseFloat(rol.getAlimentacion())+Float.parseFloat(rol.getMobilizacion())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(bonos);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(bonosa);
                border1.addCell(celda);

                Paragraph parrafo12 = new Paragraph("Préstamos Y Anticipos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo12a = new Paragraph("$ "+df.format(empresa+comunes),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo12);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo12a);
                border2.addCell(celda);

                Paragraph parrafo13 = new Paragraph("Bonos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo13a = new Paragraph("$ "+df.format(bonoss),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo13);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo13a);
                border1.addCell(celda);

                Paragraph comisariato = new Paragraph("Comisariato",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph comisariatoa = new Paragraph("$ "+df.format(comi),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(comisariato);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(comisariatoa);
                border2.addCell(celda);
                
                Paragraph fondos = new Paragraph("Fondos de Reserva",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph fondosa = new Paragraph("$ "+df.format(fondo),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                if(fondo!=0){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(fondos);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(fondosa);
                    border1.addCell(celda);
                }
                
                Paragraph parrafo14 = new Paragraph("Multas",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo14a = new Paragraph("$ "+df.format(multaa),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo14);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo14a);
                border2.addCell(celda);
                                /*****************/
                Paragraph vacaciones = new Paragraph("Liq. Vacaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph vacacionesa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getLiquidacion())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                //Vacaciones
                if(!rol.getLiquidacion().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(vacaciones);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(vacacionesa);
                    border1.addCell(celda);
                }

                Paragraph tercero = new Paragraph("Decimotercero Mensual",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph terceroa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimotercero())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                
                if(!rol.getDecimotercero().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(tercero);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(terceroa);
                    border1.addCell(celda);
                }
                
                Paragraph cuarto = new Paragraph("Decimocuarto Mensual",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph cuartoa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimocuarto())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(!rol.getDecimocuarto().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(cuarto);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(cuartoa);
                    border1.addCell(celda);
                }
                
                Paragraph excuarto = new Paragraph("Liq. Decimotercero Dic-Jul 2015",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph excuartoa;
                excuartoa = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(otros!=null){
                    excuartoa = new Paragraph("$ "+df.format(Double.parseDouble(otros.get(0).getValor())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(excuarto);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(excuartoa);
                    border1.addCell(celda);
                }
                
                Paragraph extension = new Paragraph("IESS: Extensión a Cónyuges",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona = new Paragraph("$ "+df.format(ext),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(ext!=0){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona);
                    border2.addCell(celda);

                }
                
                Paragraph extension23 = new Paragraph("Medilink",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona23 = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                if(medi!=0){
                    Float fl = Float.parseFloat(rol.getPrestamo8().replace("-", ""));
                    extensiona23 = new Paragraph("$ -"+df.format(fl),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension23);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona23);
                    border2.addCell(celda);
                }
                
                
                Paragraph extension2 = new Paragraph("Anticipo por Vacaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona2 = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(otros2!=null){
                    Float fl = Float.parseFloat(otros2.get(0).getValor().replace("-", ""));
                    extensiona2 = new Paragraph("$ -"+df.format(fl),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension2);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona2);
                    border2.addCell(celda);
                }
                
                celda= new PdfPCell(border1);
                celda.setBorder(0);
                celda.setColspan(2);
                border.addCell(celda);
                
                celda= new PdfPCell(border2);
                celda.setBorder(0);
                celda.setColspan(2);
                border.addCell(celda);
                
                Paragraph parrafo15 = new Paragraph("TOTAL INGRESOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                if(otros!=null){
                    bonoss=bonoss+Float.parseFloat(otros.get(0).getValor());
                }
                float liq= Float.parseFloat(rol.getLiquidacion());
                Float n = Float.parseFloat(rol.getSueldo()) + liq+ bonoss + fondo +sup +sup2+Float.parseFloat(rol.getDecimotercero())+Float.parseFloat(rol.getDecimocuarto())+Float.parseFloat(rol.getAlimentacion())+Float.parseFloat(rol.getComisiones())+Float.parseFloat(rol.getMobilizacion());
                Paragraph parrafo15a = new Paragraph("$ "+df.format(n),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo15);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo15a);
                border.addCell(celda);
                
                
                Paragraph parrafo16 = new Paragraph("TOTAL DESCUENTOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo16a = new Paragraph("$ "+df.format(desc).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 6, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo16);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo16a);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);


                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo17 = new Paragraph("NETO A PAGAR",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo17a = new Paragraph("$ "+rol.getTotal(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo17);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo17a);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo22 = new Paragraph("______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo22);
                border.addCell(celda);

                Paragraph parrafo18 = new Paragraph("______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo18);
                border.addCell(celda);

                Paragraph parrafo21 = new Paragraph("Emitido Por",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo21);
                border.addCell(celda);

                Paragraph parrafo19 = new Paragraph("RECIBÍ CONFORME",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo19);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo20 = new Paragraph("C.I. ______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo20);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);
                Paragraph parrafo23 = new Paragraph("Observaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                if(v6!=null){
                            celda = new PdfPCell();
                            celda.setBorder(0);
                            celda.setColspan(1);
                            celda.setPhrase(parrafo23);
                            border.addCell(celda);
                            
                            celda = new PdfPCell();
                            celda.setBorder(0);
                            celda.setColspan(3);
                            celda.setHorizontalAlignment(1);
                            celda.setPhrase(new Phrase(""));
                            border.addCell(celda);
                            
                            for(Comisiones r: v6){
                                celda = new PdfPCell();
                                celda.setBorder(0);
                                celda.setColspan(4);
                                celda.setPhrase(new Paragraph(r.getDetalle() +"por el valor de: $"+r.getValor(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0))));
                                border.addCell(celda);
                            }
                        }
                
                PdfPCell bord2 = new PdfPCell();
                bord2.setBorder(1);
                bord2= new PdfPCell(border);

                tabla.addCell(bord2);
                documento.add(tabla);
            }
            documento.close();
            helper.cerrarSesion();
        }catch(Exception ex){
            System.out.println(emp.getApellido1()+" "+emp.getApellido2());
            
            documento.close();
        }
        
    }
    
    
    public void pdftotaladmin(String mes, String anio, String dir){
        //String imagepath = Server.MapPath("Images");
        Document documento = new Document();
        float hora;
        float prestamo;
        float bonoa;
        float multaa;
        int mesnum=0;
        String[] fecha= {"Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"};
        for(int i=0; i<12;i++){
            if(fecha[i].equalsIgnoreCase(mes)){
                mesnum=i;
            }
        }
        FileOutputStream ficheroPdf;
        try
        {
            ficheroPdf = new FileOutputStream(dir+"\\"+mes+anio+"CajamarcaAdmin.pdf");
            PdfWriter.getInstance(documento,ficheroPdf).setInitialLeading(20);
        }
        catch (FileNotFoundException | DocumentException ex)
        {
            System.out.println(ex.toString());
        }
        Empleado emplead = null;
        String cadena="";
        try{
            ServiceHb helper = new ServiceHb();
            helper.iniciarTransaccion();
            documento.open();
            List<Roles> roles=helper.getRolesgenerales(mes, anio);
            int temp=0;
            int tempt=roles.size();
            for(Roles rol : roles){
                temp++;
                System.out.println(temp+"/"+tempt);
                bonoa= Float.parseFloat(rol.getBon());
                multaa= Float.parseFloat(rol.getMultas());
                hora = Float.parseFloat(rol.getReposiciones());
                if(isNumeric(rol.getCi())){
                    emplead = helper.getPersonasCid2((rol.getCi()));
                    if(emplead==null){
                        emplead = helper.getPersonasCid((rol.getCi()));
                    }
                }else{
                    emplead = helper.getPersonasCid((rol.getCi()));
                }
                if(emplead!=null){
                if(!emplead.getDeptEmpl().getDepartamento().getNombre().equalsIgnoreCase("Seguridad Fisica")){
                emp=emplead;
                List<Bono> otros =helper.getBonomesByTipo3(""+emp.getCid(),mes, anio);
                List<Prestamos> otros2 =helper.getPrestamosmesByTipo3(""+emp.getCid(),mes, anio);
                List<Comisiones> v6= helper.getComisionesmesByTipo(""+emp.getCid(), mes, anio);    
                float empresa= Float.parseFloat(rol.getPrestamo5());
                float quiro=Float.parseFloat(rol.getPrestamo2());
                float comi=Float.parseFloat(rol.getPrestamo1());
                float ext=Float.parseFloat(rol.getPrestamo3());
                float medi=Float.parseFloat(rol.getPrestamo8());
                
                float hipo=Float.parseFloat(rol.getPrestamo4());
                float coop=Float.parseFloat(rol.getPrestamo6());
                float comunes=Float.parseFloat(rol.getPrestamo7());
                prestamo= empresa+quiro+comi+ext+hipo+coop+comunes+medi;
                
                if(emp.getApellido1().contains("Aucancela")){
                    System.out.println("");
                }
                if(ext!=0){
                    if(otros2!=null){
                        ext=ext+Float.parseFloat(otros2.get(0).getValor().replace("-", ""));
                    }
                }
                float totalA=0;
                float sup= Float.parseFloat(rol.getSuplementaria());
                float sup2= Float.parseFloat(rol.getSuplementaria2());
                DecimalFormat df = new DecimalFormat("#.##");
                DecimalFormat df2 = new DecimalFormat("#.##");
                float pago=Float.parseFloat(rol.getSueldo());
                float iess=Float.parseFloat(rol.getIess());
                float fondo=Float.parseFloat(rol.getFondos());
                Image image1 = Image.getInstance(direccion+"logo-mkt.png");
                float bonoss=(bonoa + hora);
                if(otros!=null){
                    bonoss=bonoss-Float.parseFloat(otros.get(0).getValor());
                }
                float desc=  multaa - iess + prestamo;
                
                /*PDF CREATOR*/
                PdfPTable border = new PdfPTable(4);
                PdfPTable border1 = new PdfPTable(2);
                PdfPTable border2 = new PdfPTable(2);
                
                PdfPTable tabla = new PdfPTable(1);
                PdfPCell celda = new PdfPCell();
                image1.scaleAbsolute(60f, 40f);
                celda.setImage(image1);
                celda.setBorder(0);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(3);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo1 = new Paragraph("ROL DE PAGOS INDIVIDUAL",new Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                documento.add(new Paragraph(" "));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(parrafo1);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo2 = new Paragraph("EMPLEADO",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo2a = new Paragraph(emplead.getNombre1()+" "+emplead.getNombre2()+" "+emplead.getApellido1()+" "+emplead.getApellido2(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo2);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo2a);
                border1.addCell(celda);

                
                Calendar ahoraCal = Calendar.getInstance();
                Date fe = new Date();
                ahoraCal.set(Integer.parseInt(anio), mesnum, 1);
                ahoraCal.set(Integer.parseInt(anio), mesnum, ahoraCal.getActualMaximum(Calendar.DAY_OF_MONTH));
                Paragraph parrafo3 = new Paragraph("FECHA",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo3a = new Paragraph(Funcion.DateFormat(ahoraCal.getTime()),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo3);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo3a);
                border2.addCell(celda);

                Paragraph parrafo4 = new Paragraph("CARGO",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo4a = new Paragraph(emplead.getPerfilpuesto(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                Paragraph parrafo41 = new Paragraph("Dias",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo41a = new Paragraph(rol.getDias(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo4);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo4a);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo41);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo41a);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo5 = new Paragraph("INGRESOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo5a = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo5);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(new Phrase(""));
                border1.addCell(celda);

                Paragraph parrafo6 = new Paragraph("DESCUENTOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo6a = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo6);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(new Phrase(""));
                border2.addCell(celda);
                
                Paragraph parrafo7 = new Paragraph("Sueldo Base",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo7a = new Paragraph("$ "+rol.getSueldo(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                double cmi=0;
                if(v6!=null){
                    for(Comisiones z : v6){
                        cmi = cmi + Double.parseDouble(z.getValor());
                    }
                }
                Paragraph parrafocomi = new Paragraph("Comisiones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafocomia = new Paragraph("$ "+df.format(cmi).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo7);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo7a);
                border1.addCell(celda);
                if(v6!=null){
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafocomi);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafocomia);
                border1.addCell(celda);
                }
                Paragraph parrafo8 = new Paragraph("Aportes IESS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo8a = new Paragraph("$ -"+df.format(iess).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo8);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo8a);
                border2.addCell(celda);

                Paragraph parrafo9 = new Paragraph("Horas Extras",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo9a = new Paragraph("$ "+df2.format(sup2),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo9);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo9a);
                border1.addCell(celda);

                Paragraph parrafo10 = new Paragraph("Préstamos IESS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo10a = new Paragraph("$ "+df2.format(quiro+hipo),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo10);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo10a);
                border2.addCell(celda);

                Paragraph bonos;
                if((sup+Float.parseFloat(rol.getAlimentacion()))<300){
                    bonos = new Paragraph("Alimentación y Transporte",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                }else{
                    bonos = new Paragraph("Alimentación y Viaticos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                }
                Paragraph bonosa = new Paragraph("$ "+df.format(sup+Float.parseFloat(rol.getAlimentacion())+Float.parseFloat(rol.getMobilizacion())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(bonos);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(bonosa);
                border1.addCell(celda);

                Paragraph parrafo12 = new Paragraph("Préstamos Y Anticipos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo12a = new Paragraph("$ "+df.format(empresa+comunes),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo12);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo12a);
                border2.addCell(celda);

                Paragraph parrafo13 = new Paragraph("Bonos",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo13a = new Paragraph("$ "+df.format(bonoss),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo13);
                border1.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo13a);
                border1.addCell(celda);

                Paragraph comisariato = new Paragraph("Comisariato",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph comisariatoa = new Paragraph("$ "+df.format(comi),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(comisariato);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(comisariatoa);
                border2.addCell(celda);
                
                Paragraph fondos = new Paragraph("Fondos de Reserva",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph fondosa = new Paragraph("$ "+df.format(fondo),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                if(fondo!=0){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(fondos);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(fondosa);
                    border1.addCell(celda);
                }
                
                Paragraph parrafo14 = new Paragraph("Multas",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo14a = new Paragraph("$ "+df.format(multaa),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo14);
                border2.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo14a);
                border2.addCell(celda);
                                /*****************/
                Paragraph vacaciones = new Paragraph("Liq. Vacaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph vacacionesa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getLiquidacion())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                //Vacaciones
                if(!rol.getLiquidacion().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(vacaciones);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(vacacionesa);
                    border1.addCell(celda);
                }

                Paragraph tercero = new Paragraph("Decimotercero Mensual",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph terceroa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimotercero())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                
                if(!rol.getDecimotercero().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(tercero);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(terceroa);
                    border1.addCell(celda);
                }
                
                Paragraph cuarto = new Paragraph("Decimocuarto Mensual",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph cuartoa = new Paragraph("$ "+df.format(Double.parseDouble(rol.getDecimocuarto())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(!rol.getDecimocuarto().equalsIgnoreCase("0")){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(cuarto);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(cuartoa);
                    border1.addCell(celda);
                }
                
                Paragraph excuarto = new Paragraph("Liq. Decimotercero Dic-Jul 2015",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph excuartoa = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(otros!=null){
                    excuartoa = new Paragraph("$ "+df.format(Double.parseDouble(otros.get(0).getValor())),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(excuarto);
                    border1.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(excuartoa);
                    border1.addCell(celda);
                }
                
                Paragraph extension = new Paragraph("IESS: Extensión a Cónyuges",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona = new Paragraph("$ "+df.format(ext),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(ext!=0){
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona);
                    border2.addCell(celda);

                }
                Paragraph extension23 = new Paragraph("Medilink",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona23 = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                if(medi!=0){
                    Float fl = Float.parseFloat(rol.getPrestamo8().replace("-", ""));
                    extensiona23 = new Paragraph("$ -"+df.format(fl),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension23);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona23);
                    border2.addCell(celda);
                }
                
                Paragraph extension2 = new Paragraph("Anticipo por Vacaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph extensiona2 = new Paragraph("",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                if(otros2!=null){
                    Float fl = Float.parseFloat(otros2.get(0).getValor().replace("-", ""));
                    extensiona2 = new Paragraph("$ -"+df.format(fl),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setPhrase(extension2);
                    border2.addCell(celda);

                    celda = new PdfPCell();
                    celda.setBorder(0);
                    celda.setHorizontalAlignment(2);
                    celda.setPhrase(extensiona2);
                    border2.addCell(celda);
                }
                
                celda= new PdfPCell(border1);
                celda.setBorder(0);
                celda.setColspan(2);
                border.addCell(celda);
                
                celda= new PdfPCell(border2);
                celda.setBorder(0);
                celda.setColspan(2);
                border.addCell(celda);
                
                Paragraph parrafo15 = new Paragraph("TOTAL INGRESOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                if(otros!=null){
                    bonoss=bonoss+Float.parseFloat(otros.get(0).getValor());
                }
                float liq= Float.parseFloat(rol.getLiquidacion());
                Float n = Float.parseFloat(rol.getSueldo()) + bonoss + liq+ fondo +sup +sup2+Float.parseFloat(rol.getDecimotercero())+Float.parseFloat(rol.getDecimocuarto())+Float.parseFloat(rol.getAlimentacion())+Float.parseFloat(rol.getComisiones())+Float.parseFloat(rol.getMobilizacion());
                Paragraph parrafo15a = new Paragraph("$ "+df.format(n),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo15);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo15a);
                border.addCell(celda);
                
                
                Paragraph parrafo16 = new Paragraph("TOTAL DESCUENTOS",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo16a = new Paragraph("$ "+df.format(desc).replace(",", "."),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 6, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo16);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo16a);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);


                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo17 = new Paragraph("NETO A PAGAR",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                Paragraph parrafo17a = new Paragraph("$ "+rol.getTotal(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setPhrase(parrafo17);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setHorizontalAlignment(2);
                celda.setPhrase(parrafo17a);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo22 = new Paragraph("______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo22);
                border.addCell(celda);

                Paragraph parrafo18 = new Paragraph("______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo18);
                border.addCell(celda);

                Paragraph parrafo21 = new Paragraph("Emitido Por",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo21);
                border.addCell(celda);

                Paragraph parrafo19 = new Paragraph("RECIBÍ CONFORME",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo19);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(2);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);

                Paragraph parrafo20 = new Paragraph("C.I. ______________________________",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0)));
                
                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setHorizontalAlignment(1);
                celda.setPhrase(parrafo20);
                border.addCell(celda);

                celda = new PdfPCell();
                celda.setBorder(0);
                celda.setColspan(4);
                celda.setPhrase(new Phrase(""));
                border.addCell(celda);
                Paragraph parrafo23 = new Paragraph("Observaciones",new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.BOLD, new Color(0, 0, 0)));
                if(v6!=null){
                            celda = new PdfPCell();
                            celda.setBorder(0);
                            celda.setColspan(1);
                            celda.setPhrase(parrafo23);
                            border.addCell(celda);
                            
                            celda = new PdfPCell();
                            celda.setBorder(0);
                            celda.setColspan(3);
                            celda.setHorizontalAlignment(1);
                            celda.setPhrase(new Phrase(""));
                            border.addCell(celda);
                            
                            for(Comisiones r: v6){
                                celda = new PdfPCell();
                                celda.setBorder(0);
                                celda.setColspan(4);
                                celda.setPhrase(new Paragraph(r.getDetalle() +"por el valor de: $"+r.getValor(),new com.itextpdf.text.Font(com.itextpdf.text.Font.HELVETICA, 7, com.itextpdf.text.Font.NORMAL, new Color(0, 0, 0))));
                                border.addCell(celda);
                            }
                        }
                
                PdfPCell bord2 = new PdfPCell();
                bord2.setBorder(1);
                bord2= new PdfPCell(border);

                tabla.addCell(bord2);
                documento.add(tabla);
            }
            }
            }
            documento.close();
            helper.cerrarSesion();
        }catch(Exception ex){
            System.out.println(emplead.getApellido1());
            documento.close();
        }
        
    }
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JComboBox jComboBox1;
    private javax.swing.JComboBox jComboBox2;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable jTable1;
    private javax.swing.JTextField jTextField1;
    // End of variables declaration//GEN-END:variables
}
